<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
<meta property="og:type" content="website">
<meta property="og:title" content="é€†å‘å…‰ç‚¹">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="é€†å‘å…‰ç‚¹">
<meta property="og:description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="UmVfX1BvaW50">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>é€†å‘å…‰ç‚¹</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">é€†å‘å…‰ç‚¹</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Affine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Affine/" class="post-title-link" itemprop="url">Affine</a>
        </h2>

        <div class="post-meta">
          
            <i class="fa fa-thumb-tack"></i>
            <font color=7D26CD>ç½®é¡¶</font>
            <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:06:39" itemprop="dateCreated datePublished" datetime="2023-03-31T19:06:39+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 00:50:02" itemprop="dateModified" datetime="2023-04-01T00:50:02+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><h3 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h3><ul>
<li>ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨åŠ å¯†å‡½æ•°å°†ä¸€ä¸ªå­—æ¯æ˜ å°„ä¸ºå¦ä¸€ä¸ªå­—æ¯</li>
</ul>
<h3 id="åŠ å¯†å‡½æ•°"><a href="#åŠ å¯†å‡½æ•°" class="headerlink" title="åŠ å¯†å‡½æ•°"></a>åŠ å¯†å‡½æ•°</h3><h4 id="E-x-x3D-ax-b-n-å…¶ä¸­"><a href="#E-x-x3D-ax-b-n-å…¶ä¸­" class="headerlink" title="E(x) &#x3D; (ax+b)%n,å…¶ä¸­"></a>E(x) &#x3D; (ax+b)%n,å…¶ä¸­</h4><ul>
<li>nä¸ºæ‰€è®¾ç½®çš„å­—æ¯ç¼–ç è¡¨çš„å¤§å°</li>
<li>a,bä¸ºè‡ªé€‰æ•°ï¼Œåªè¦æ»¡è¶³aä¸näº’è´¨å³å¯</li>
<li>xä¸ºæ˜æ–‡ç¼–ç åçš„æ•°å­—</li>
</ul>
<h3 id="è§£å¯†å‡½æ•°"><a href="#è§£å¯†å‡½æ•°" class="headerlink" title="è§£å¯†å‡½æ•°"></a>è§£å¯†å‡½æ•°</h3><h4 id="D-x-x3D-a-1-x-b-n"><a href="#D-x-x3D-a-1-x-b-n" class="headerlink" title="D(x) &#x3D; a-1(x-b)%n"></a>D(x) &#x3D; a-1(x-b)%n</h4><ul>
<li>a-1æ˜¯aåœ¨Znç¾¤çš„ä¹˜æ³•é€†å…ƒ</li>
</ul>
<blockquote>
<p>ä¹˜æ³•é€†å…ƒè¿™ä¸ªä¸œè¥¿ç­‰åç»­å®Œå…¨ææ‡‚äº†å†è§£é‡Šï¼Œä¸»è¦çš„ä¸€ç‚¹æ˜¯æ»¡è¶³a-1*a%n&#x3D;1</p>
</blockquote>
<h2 id="ä¾‹é¢˜-BITSCTF2017-fanfie"><a href="#ä¾‹é¢˜-BITSCTF2017-fanfie" class="headerlink" title="ä¾‹é¢˜ [BITSCTF2017]fanfie"></a>ä¾‹é¢˜ [BITSCTF2017]fanfie</h2><blockquote>
<p>Brute and get the base 32 format of flag.<br>encrypted.txt: MZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</p>
</blockquote>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><p>é¢˜ç›®æ˜¯ä¸€å¦‚æ—¢å¾€çš„ç®€æ´<br>é¦–å…ˆé¢˜ç›®å‘Šè¯‰æˆ‘ä»¬æœ‰base32ç¼–ç <br>åŒæ—¶ç”±é¢˜ç›®æ¥æºå¯çŸ¥flagæ ¼å¼ä¸ºBITSCTF{}</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ç„å­¦çŒœæƒ³:<br>ç¼–ç åå˜é•¿äº†ï¼Œæˆ–è®¸åˆšå¥½å’Œé¢˜ç›®ç»™çš„å¯†æ–‡ç­‰é•¿å§ï¼Œè€ƒè™‘å•è¡¨åŠ å¯†<br>Iå˜Mï¼ŒJå˜Zï¼ŒEå˜Yï¼Œå¾ˆæ˜æ˜¾æ²¡ç›´æ¥çš„æ˜ å°„è§„å¾‹ï¼Œè€ƒè™‘<a target="_blank" rel="noopener" href="http://woodenmandu.cn/2022/09/06/Affine/">ä»¿å°„å¯†ç </a></p>
<p>ä¸‹ä¸€æ­¥è®¡ç®—aï¼Œb</p>
<blockquote>
<p>åˆ«å¿˜è®°è¿™æ˜¯base32ï¼ŒåŠ å¯†å‡½æ•°ä¸ºE(x) &#x3D; (ax+b)%32</p>
</blockquote>
<ul>
<li><p>å°ç®—ä¸€ä¸‹ï¼Œæ‹¿ä¸¤ç»„æ•°æ®ï¼š</p>
<blockquote>
<p>8(I)â€“&gt;12(M)<br>9(J)â€“&gt;25(Z)</p>
</blockquote>
</li>
<li><p>å‡½æ•°å·®å€¼æä¸€ä¸‹ï¼š25-12&#x3D;(9-1)a<br>a&#x3D;13ï¼Œbé¡ºç†æˆç« ç­‰äº4</p>
</li>
<li><p>ç„¶ågoogleæ‰¾ä¸ªæ±‚é€†å…ƒçš„ç½‘ç«™å¾—åˆ°é€†å…ƒç­‰äº5<br>å¾—åˆ°è§£å¯†å‡½æ•°D(x) &#x3D; 5(x-4)%32</p>
</li>
</ul>
<p>é€šè¿‡è§£å¯†å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯†æ–‡ï¼šMZYVMIWLGBL7CIJOGJQVOA3IN5BLYC3NHI</span><br><span class="line">æ˜æ–‡ï¼šIJEVIU2DKRDHWUZSKZ4VSMTUN5RDEWTNPU</span><br></pre></td></tr></table></figure>

<p>æœ€åbase32è§£ç å°±èƒ½å¾—åˆ°flag:</p>
<blockquote>
<p>BITSCTF{S2VyY2tob2Zm}</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Android/" class="post-title-link" itemprop="url">Android-base</a>
        </h2>

        <div class="post-meta">
          
            <i class="fa fa-thumb-tack"></i>
            <font color=7D26CD>ç½®é¡¶</font>
            <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 18:51:42" itemprop="dateCreated datePublished" datetime="2023-03-31T18:51:42+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:06:08" itemprop="dateModified" datetime="2023-04-01T10:06:08+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index"><span itemprop="name">Android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å®‰å“ç³»ç»Ÿæ¶æ„"><a href="#å®‰å“ç³»ç»Ÿæ¶æ„" class="headerlink" title="å®‰å“ç³»ç»Ÿæ¶æ„"></a>å®‰å“ç³»ç»Ÿæ¶æ„</h2><ul>
<li>åº”ç”¨å±‚</li>
<li>åº”ç”¨æ¡†æ¶<ul>
<li>åº”ç”¨å¼€å‘ç»„ä»¶ã€å¼€å‘åŒ…</li>
</ul>
</li>
<li>dalvikè™šæ‹Ÿæœº<ul>
<li>Googleè‡ªå·±è®¾è®¡ç”¨äºAndroidå¹³å°çš„è™šæ‹Ÿæœºï¼Œå¯æ”¯æŒ.dexæ ¼å¼çš„javaåº”ç”¨ç¨‹åºè¿è¡Œ</li>
</ul>
</li>
<li>linuxå†…æ ¸<ul>
<li>åŒ…æ‹¬ä¸€äº›ç³»ç»Ÿé©±åŠ¨ç­‰</li>
</ul>
</li>
</ul>
<h2 id="apkç›®å½•ç»“æ„"><a href="#apkç›®å½•ç»“æ„" class="headerlink" title="apkç›®å½•ç»“æ„"></a>apkç›®å½•ç»“æ„</h2><ol>
<li>assets<ul>
<li>é™æ€æ–‡ä»¶ï¼Œapkæ‰€ä½¿ç”¨çš„å„ç§èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰ï¼Œé€šè¿‡APIè·å–</li>
</ul>
</li>
<li>res<ul>
<li>ç¼–è¯‘åçš„èµ„æºæ–‡ä»¶</li>
</ul>
</li>
<li>lib<ul>
<li>soåŠ¨æ€é“¾æ¥åº“ï¼Œç”¨äºåº•å±‚çš„ä¸€äº›è°ƒç”¨</li>
</ul>
</li>
<li>dex<ul>
<li>è™šæ‹Ÿæœºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸»è¦é€†å‘ç›®æ ‡</li>
</ul>
</li>
<li>META-INF<ul>
<li>æ•°å­—ç­¾åï¼Œç”¨äºæ ¡éªŒapkæ˜¯å¦è¢«ç¯¡æ”¹</li>
</ul>
</li>
<li>AndroidManifest.xml<ul>
<li>ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„é…ç½®æ¸…å•ï¼Œå£°æ˜æƒé™ã€ç»„ä»¶ç­‰çš„åŸºæœ¬ä¿¡æ¯</li>
</ul>
</li>
<li>resources.arsc<ul>
<li>ç¼–è¯‘åèµ„æºçš„ä½ç½®ä¸idä¹‹é—´çš„æ˜ å°„å…³ç³»</li>
</ul>
</li>
</ol>
<h2 id="Androidå››å¤§ç»„ä»¶"><a href="#Androidå››å¤§ç»„ä»¶" class="headerlink" title="Androidå››å¤§ç»„ä»¶"></a>Androidå››å¤§ç»„ä»¶</h2><ol>
<li>activity<ul>
<li>ç”¨æˆ·å¯è§†åŒ–ç•Œé¢</li>
<li>safeï¼š1.ç‚¹å‡»åŠ«æŒ 2.æ‹’ç»æœåŠ¡ 3.ç»„ä»¶å¯¼å‡º</li>
</ul>
</li>
<li>service<ul>
<li>ç”¨äºåå°å®ç°æ“ä½œï¼Œå¦‚åå°æ¥å—å¾®ä¿¡æ¶ˆæ¯</li>
<li>safeï¼š1.ä¸²è°‹æ”»å‡» 2.æ‹’ç»æœåŠ¡</li>
</ul>
</li>
<li>content provider<ul>
<li>ä¸ºåº”ç”¨æä¾›æ•°æ®ï¼Œç»Ÿä¸€æ¥å£</li>
<li>safeï¼š1.æ•°æ®åº“æ³¨å…¥</li>
</ul>
</li>
<li>broadcast receiver<ul>
<li>ä¿¡æ¯ä¼ è¾“æœºåˆ¶</li>
<li>safeï¼šæ¶æ„å¹¿æ’­</li>
</ul>
</li>
</ol>
<p>æ³¨ï¼šæ‰€æœ‰ç»„ä»¶å‡éœ€åœ¨AndroidManifestä¸­æ³¨å†Œå£°æ˜</p>
<p>å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/ican87/article/details/21874321">(1æ¡æ¶ˆæ¯) androidå››å¤§ç»„ä»¶(è¯¦ç»†æ€»ç»“)_87nowçš„åšå®¢-CSDNåšå®¢_androidçš„å››å¤§ç»„ä»¶</a></p>
<h2 id="Androidæ‰“åŒ…æµç¨‹"><a href="#Androidæ‰“åŒ…æµç¨‹" class="headerlink" title="Androidæ‰“åŒ…æµç¨‹"></a>Androidæ‰“åŒ…æµç¨‹</h2><h2 id="Androidå®‰è£…æµç¨‹"><a href="#Androidå®‰è£…æµç¨‹" class="headerlink" title="Androidå®‰è£…æµç¨‹"></a>Androidå®‰è£…æµç¨‹</h2><ul>
<li>å¤åˆ¶APkå®‰è£…åŒ…åˆ°data&#x2F;appç›®å½•ä¸‹ï¼Œè§£å‹æ‰«æå®‰è£…åŒ…ï¼ŒæŠŠdexæ–‡ä»¶ä¿å­˜åˆ°dalvik-cacheç›®å½•ï¼Œå¹¶åœ¨data&#x2F;dataç›®å½•åˆ›å»ºå¯¹åº”çš„åº”ç”¨æ•°æ®ã€‚ï¼ˆAndroidManifest.xmlï¼‰</li>
</ul>
<h2 id="armæµæ°´çº¿"><a href="#armæµæ°´çº¿" class="headerlink" title="armæµæ°´çº¿"></a>armæµæ°´çº¿</h2><ul>
<li>PCï¼šç¨‹åºè®¡æ•°å™¨ã€‚æ°¸è¿œæŒ‡å‘å–æŒ‡åœ°å€</li>
<li>IFï¼šå–æŒ‡ã€‚åŒæ—¶ç¡®å®šä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼ˆæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼‰</li>
<li>IDï¼šè¯‘ç ã€‚åŒæ—¶ç»™å‡ºå³å°†ä½¿ç”¨çš„å¯„å­˜å™¨ï¼Œæˆ–è€…è®©ç«‹å³æ•°è¿›è¡Œæ‹“å±•ï¼Œäº¦æˆ–è€…æ˜¯ç»™å‡ºè½¬ç§»ç›®çš„å¯„å­˜å™¨ä¸è½¬ç§»æ¡ä»¶ï¼ˆè½¬ç§»æŒ‡ä»¤ï¼‰</li>
<li>EXï¼šæ‰§è¡Œã€‚</li>
<li>MEMï¼šè®¿å­˜ã€‚è‹¥ä¸ºload&#x2F;storeæŒ‡ä»¤ï¼Œè¿™ä¸ªé˜¶æ®µå°±è¦è®¿é—®å­˜å‚¨å™¨ã€‚å¦å¤–ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µè¿˜è¦åˆ¤å®šæ˜¯å¦æœ‰å¼‚å¸¸è¦å¤„ç†ï¼Œå¦‚æœæœ‰ï¼Œé‚£ä¹ˆå°±æ¸…é™¤æµæ°´çº¿ï¼Œç„¶åè½¬ç§»åˆ°å¼‚å¸¸å¤„ç†ä¾‹ç¨‹å…¥å£åœ°å€å¤„ç»§ç»­æ‰§è¡Œ</li>
<li>WBï¼šå›å†™ã€‚å°†è¿ç®—ç»“æœä¿å­˜åˆ°ç›®æ ‡å¯„å­˜å™¨</li>
</ul>
<h4 id="ä¸‰çº§æµæ°´çº¿"><a href="#ä¸‰çº§æµæ°´çº¿" class="headerlink" title="ä¸‰çº§æµæ°´çº¿"></a>ä¸‰çº§æµæ°´çº¿</h4><ul>
<li>å–æŒ‡â€“&gt;è¯‘ç â€“&gt;æ‰§è¡Œ</li>
<li>pcâ€“&gt;pc-4â€“&gt;pc-8 (arm7)</li>
</ul>
<h4 id="äº”çº§æµæ°´çº¿"><a href="#äº”çº§æµæ°´çº¿" class="headerlink" title="äº”çº§æµæ°´çº¿"></a>äº”çº§æµæ°´çº¿</h4><ul>
<li>å–æŒ‡â€“&gt;è¯‘ç â€“&gt;æ‰§è¡Œâ€“&gt;è®¿å­˜â€“&gt;å›å†™ (arm9)</li>
</ul>
<h4 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h4><ul>
<li>æˆ‘è§‰å¾—éœ€è¦å¼ºè°ƒçš„ä¸€ä¸ªç‚¹æ˜¯ç†è®ºå’Œå®è·µæ˜¯ä¸ä¸€æ ·çš„ã€‚ä¸ä¸€å®šæ‰€æœ‰æŒ‡ä»¤éƒ½è¦ç»å†æµæ°´çº¿çš„æ¯ä¸ªè¿‡ç¨‹</li>
<li>å…·ä½“å‚è€ƒæ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/438259856">CPUè®¾è®¡â€”äº”çº§æµæ°´çº¿ - çŸ¥ä¹ (zhihu.com)</a></li>
</ul>
<h2 id="ADB"><a href="#ADB" class="headerlink" title="ADB"></a>ADB</h2><ul>
<li>adb devices åˆ—å‡ºå½“å‰å®‰å“è®¾å¤‡</li>
<li>adb shell è¿›å…¥å®‰å“linuxå‘½ä»¤è¡Œ</li>
<li>adb push ä¸Šä¼ </li>
<li>adb pull ä¸‹è½½</li>
<li>adb connect ipè¿æ¥è®¾å¤‡</li>
<li>adb kill-server æ–­å¼€è¿æ¥</li>
<li>adb forward tcp:23946 tcp:23946 ç«¯å£è½¬ç§»åˆ°æœ¬åœ°</li>
<li>adb shell dumpsys activity top æŸ¥çœ‹é¡¶å±‚é¡µé¢ä¿¡æ¯</li>
<li>adb shell dbinfo æŸ¥çœ‹appä½¿ç”¨çš„æ•°æ®åº“ä¿¡æ¯</li>
<li>adb shell screencap -p [path] æˆªå±</li>
<li>adb shell input text [text] æ–‡æœ¬æ¡†è¾“å…¥</li>
<li>adb shell pm install &#x2F; pm uninstall &#x2F; pm list packages</li>
<li>adb shell am start-activity -D -N [åŒ…å] debug</li>
</ul>
<h2 id="termuxä½¿ç”¨"><a href="#termuxä½¿ç”¨" class="headerlink" title="termuxä½¿ç”¨"></a>termuxä½¿ç”¨</h2><ul>
<li>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://f-droid.org/packages/com.termux/">Termux | F-Droid - Free and Open Source Android App Repository</a></li>
</ul>
<h4 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><ul>
<li><p>termux-setup-storage è·å–å­˜å‚¨æƒé™</p>
</li>
<li><p>pkg install &lt;è½¯ä»¶å&gt; å®‰è£…è½¯ä»¶</p>
</li>
<li><p>pkg upgrade æ›´æ–°è½¯ä»¶</p>
<p>termux-change-repo åˆ‡æ¢æº</p>
</li>
</ul>
<h2 id="é™æ€æ’æ¡©"><a href="#é™æ€æ’æ¡©" class="headerlink" title="é™æ€æ’æ¡©"></a>é™æ€æ’æ¡©</h2><ul>
<li>æ‰¾åˆ°å‡½æ•°å…¥å£ç‚¹</li>
</ul>
<h2 id="æ•æ„Ÿä¿¡æ¯"><a href="#æ•æ„Ÿä¿¡æ¯" class="headerlink" title="æ•æ„Ÿä¿¡æ¯"></a>æ•æ„Ÿä¿¡æ¯</h2><h4 id="åŠ¨æ€æ³¨å†Œ"><a href="#åŠ¨æ€æ³¨å†Œ" class="headerlink" title="åŠ¨æ€æ³¨å†Œ"></a>åŠ¨æ€æ³¨å†Œ</h4><ul>
<li>Jni_OnLoad</li>
</ul>
<h4 id="ç­¾å"><a href="#ç­¾å" class="headerlink" title="ç­¾å"></a>ç­¾å</h4><ul>
<li>getPackageManager</li>
<li>getPackageInfo</li>
<li>signatures</li>
</ul>
<h4 id="æ¨¡æ‹Ÿå™¨æ£€æµ‹"><a href="#æ¨¡æ‹Ÿå™¨æ£€æµ‹" class="headerlink" title="æ¨¡æ‹Ÿå™¨æ£€æµ‹"></a>æ¨¡æ‹Ÿå™¨æ£€æµ‹</h4><ul>
<li>checkcpuinfo</li>
</ul>
<h4 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="headerlink" title="åè°ƒè¯•"></a>åè°ƒè¯•</h4><ul>
<li>android-server</li>
</ul>
<h2 id="apktoolåç¼–è¯‘å‘½ä»¤"><a href="#apktoolåç¼–è¯‘å‘½ä»¤" class="headerlink" title="apktoolåç¼–è¯‘å‘½ä»¤"></a>apktoolåç¼–è¯‘å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apktoolç›®å½•è¿›å…¥å‘½ä»¤è¡Œ</span><br><span class="line">apktool.bat d åç¼–è¯‘æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h2 id="dex2-jdguiåç¼–è¯‘"><a href="#dex2-jdguiåç¼–è¯‘" class="headerlink" title="dex2+jdguiåç¼–è¯‘"></a>dex2+jdguiåç¼–è¯‘</h2><ol>
<li>ä¿®æ”¹apkæ–‡ä»¶åç¼€ä¸ºzipï¼Œè§£å‹</li>
<li>å°†åç¼–çš„dexæ–‡ä»¶å¤åˆ¶åˆ°dex2jarå·¥å…·ç›®å½•ä¸‹</li>
<li>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆjaræ–‡ä»¶</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d2j-dex2jar.bat document_name.dex</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå‡ºç°ä¸‹åˆ—æŠ¥é”™(ç‰ˆæœ¬å·ä¸åŒ¹é…):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">com.googlecode.d2j.DexException: not support version.</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:151)</span><br><span class="line">     at com.googlecode.d2j.reader.DexFileReader.&lt;init&gt;(DexFileReader.java:211)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.doCommandLine(Dex2jarCmd.java:104)</span><br><span class="line">     at com.googlecode.dex2jar.tools.BaseCmd.doMain(BaseCmd.java:288)</span><br><span class="line">     at com.googlecode.dex2jar.tools.Dex2jarCmd.main(Dex2jarCmd.java:32)</span><br></pre></td></tr></table></figure>


<p>ç”¨æ–‡æœ¬ç¼–è¾‘è½¯ä»¶æ‰“å¼€dexæ–‡ä»¶ï¼Œå°†æ–‡ä»¶å¤´æ”¹ä¸º035æˆ–è€…036</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dex</span><br><span class="line">037 9!Q&lt;â‚¬é¢§â‚¬?æ»£^î–¼æ°¶wl?  p   x</span><br></pre></td></tr></table></figure>


<p>æ­£å¸¸æƒ…å†µåº”è¯¥æ˜¯è¿™æ ·çš„(æ²¡æœ‰ä»»ä½•å¤šä½™)ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\SoftWarePackage\Jd-GUI+dex2\dex2jar-2.0&gt;d2j-dex2jar.bat classes3.dex</span><br><span class="line">    dex2jar classes3.dex -&gt; .\classes3-dex2jar.jar</span><br></pre></td></tr></table></figure>



<ol>
<li><p>ç”¨jd-guijaråç¼–è¯‘jaræ–‡ä»¶ï¼Œå‘½ä»¤æ˜¯è¿™ä¸ªï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jd-gui-1.5.0.jar</span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶å®å°±æ˜¯æ‰§è¡Œjaræ–‡ä»¶è€Œå·²ï¼Œå¯ä»¥ç›´æ¥å†™batæ¡Œé¢ä¸€é”®æ‰“å¼€</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Shell/" class="post-title-link" itemprop="url">Script</a>
        </h2>

        <div class="post-meta">
          
            <i class="fa fa-thumb-tack"></i>
            <font color=7D26CD>ç½®é¡¶</font>
            <span class="post-meta-divider">|</span>
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 18:39:29" itemprop="dateCreated datePublished" datetime="2023-03-31T18:39:29+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:02:26" itemprop="dateModified" datetime="2023-04-01T10:02:26+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¥ä¸æƒ³å†™çš„ï¼Œåæ¥å‘ç°è‡ªå·±è„‘å­ä¸å¤ªè¡Œæ ¹æœ¬è®°ä¸ä½ï¼ŒæŸ¥åˆä¸æƒ³æŸ¥ï¼Œæ‰€ä»¥æ…¢æ…¢ç§¯ç´¯å§ï¼Œæ€»æœ‰ä¸€å¤©ä¼šç”¨åˆ°çš„<br>æˆ‘çš„è®¾æƒ³æ˜¯ç­‰æœªæ¥è¾¾åˆ°ä¸€å®šæ•°é‡ä»¥åå†æŒ‰pythonåº“æ•´ç†ï¼Œç°åœ¨çš„è¯å°±è¿™æ ·æ•£ç€</p>
<h2 id="IDCçˆ¬æ•°æ®"><a href="#IDCçˆ¬æ•°æ®" class="headerlink" title="IDCçˆ¬æ•°æ®"></a>IDCçˆ¬æ•°æ®</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> addr = <span class="number">0x0000000100008000</span>;</span><br><span class="line"><span class="keyword">auto</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(i; i &lt; <span class="number">10</span>; i = i+<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">Message</span>(<span class="string">&quot;%x&quot;</span>,<span class="built_in">Byte</span>(addr+i));</span><br><span class="line">	<span class="comment">//PatchByte(addr+i,Byte());</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="sha1åŠ å¯†"><a href="#sha1åŠ å¯†" class="headerlink" title="sha1åŠ å¯†"></a>sha1åŠ å¯†</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">origin = <span class="built_in">input</span>()</span><br><span class="line">temp = hashlib.<span class="built_in">sha1</span>(origin.<span class="built_in">encode</span>())</span><br><span class="line"><span class="built_in">print</span>(temp.<span class="built_in">hexdigest</span>())</span><br></pre></td></tr></table></figure>

<h2 id="æ±‚æ¨¡ä¹˜é€†å…ƒ"><a href="#æ±‚æ¨¡ä¹˜é€†å…ƒ" class="headerlink" title="æ±‚æ¨¡ä¹˜é€†å…ƒ"></a>æ±‚æ¨¡ä¹˜é€†å…ƒ</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># e*d mod Ï†(n) = 1</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = <span class="string">&#x27;e&#x27;</span></span><br><span class="line">phi = <span class="string">&#x27;Ï†(n)&#x27;</span></span><br><span class="line">d = gmpy2.<span class="built_in">invert</span>(e,phi)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure>

<h2 id="RSAå…±æ¨¡æ”»å‡»"><a href="#RSAå…±æ¨¡æ”»å‡»" class="headerlink" title="RSAå…±æ¨¡æ”»å‡»"></a>RSAå…±æ¨¡æ”»å‡»</h2><ul>
<li><p>ä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ•°n</p>
</li>
<li><p>ç”¨ä¸¤ä¸ªä¸åŒçš„å…¬é’¥e1ã€e2å¯¹åŒä¸€æ®µæ˜æ–‡mè¿›è¡ŒåŠ å¯†å¾—åˆ°ä¸¤ä»½å¯†æ–‡c1ã€c2</p>
</li>
<li><p>è§£å¯†å…¬å¼ï¼š</p>
<blockquote>
<p>m &#x3D; (c1s1 % n * c2s2 % n) % n</p>
</blockquote>
</li>
<li><p>å…¬å¼æ¨å¯¼ï¼š</p>
<ul>
<li>ç”±å…±æ¨¡å¯æ¨å‡º<ul>
<li>me1 % n &#x3D; c1</li>
<li>me2 % n &#x3D; c2</li>
</ul>
</li>
<li>æ¬§å‡ é‡Œå¾—æ‰©å±•ç®—æ³•å–s1ã€s2ä½¿å¾—<ul>
<li>e1 * s1 + e2 * s2 &#x3D; 1</li>
</ul>
</li>
<li>m &#x3D; m(e1<em>s1+e2</em>s2) % n</li>
<li>m &#x3D; (c1s1 % n * c2s2 % n) % n</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span>  binascii</span><br><span class="line">c1 =</span><br><span class="line">n =</span><br><span class="line">e1 =</span><br><span class="line">c2 =</span><br><span class="line">e2 =</span><br><span class="line">r,s1,s2 = gmpy2.<span class="built_in">gcdext</span>(e1, e2)    # æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</span><br><span class="line"># å…¬å¼</span><br><span class="line">m = (gmpy2.<span class="built_in">powmod</span>(c1,s1,n)*gmpy2.<span class="built_in">powmod</span>(c2,s2,n)) % n   # è®¡ç®—æ˜æ–‡m</span><br><span class="line">m = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(binascii.<span class="built_in">unhexlify</span>(m))</span><br></pre></td></tr></table></figure>

<h2 id="RSAå·²çŸ¥pé«˜ä½æ”»å‡»"><a href="#RSAå·²çŸ¥pé«˜ä½æ”»å‡»" class="headerlink" title="RSAå·²çŸ¥pé«˜ä½æ”»å‡»"></a>RSAå·²çŸ¥pé«˜ä½æ”»å‡»</h2><ul>
<li><p>ç”Ÿæˆæ¨¡å¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">from gmpy2 <span class="keyword">import</span> *</span><br><span class="line">from secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line">m=<span class="built_in">bytes_to_long</span>(flag)</span><br><span class="line">p=<span class="built_in">getprime</span>(<span class="number">512</span>)</span><br><span class="line">q=<span class="built_in">getprime</span>(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&#123;&#125;&quot;</span>.format(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.format(c))</span><br><span class="line">tmp=random.<span class="built_in">randint</span>(<span class="number">100</span>,<span class="number">300</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p&gt;&gt;tmp=&#123;&#125;&quot;</span>.format(p&gt;&gt;tmp))</span><br><span class="line"><span class="meta">#c=6423951485971717307108570552094997465421668596714747882611104648100280293836248438862138501051894952826415798421772671979484920170142688929362334687355938148152419374972520025565722001651499172379146648678015238649772132040797315727334900549828142714418998609658177831830859143752082569051539601438562078140 </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#n=102089505560145732952560057865678579074090718982870849595040014068558983876754569662426938164259194050988665149701199828937293560615459891835879217321525050181965009152805251750575379985145711513607266950522285677715896102978770698240713690402491267904700928211276700602995935839857781256403655222855599880553</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#p&gt;&gt;200=8183408885924573625481737168030555426876736448015512229437332241283388177166503450163622041857</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>sageè„šæœ¬æ±‚p</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">p = </span><br><span class="line">p = p &lt;&lt; bits				<span class="comment">//bitsä¸ºæ±‚è§£ä½æ•°ï¼Œæ¯”å¦‚å·²çŸ¥312ä½p2ï¼Œpä¸º512ä½ï¼Œbits = 200</span></span><br><span class="line">PR. = <span class="built_in">PolynomialRing</span>(<span class="built_in">Zmod</span>(n))</span><br><span class="line">f = x + p</span><br><span class="line">roots = f.<span class="built_in">small_roots</span>(X=<span class="number">2</span> ^ bits,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»"><a href="#RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»" class="headerlink" title="RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»"></a>RSAå·²çŸ¥æ˜æ–‡mé«˜ä½æ”»å‡»</h2><ul>
<li><p>ç”Ÿæˆæ¨¡å¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">from secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">flag=<span class="string">&quot;UNCTF&#123;*************************&#125;&quot;</span> </span><br><span class="line">m=libnum.<span class="built_in">s2n</span>(flag)</span><br><span class="line">p=libnum.<span class="built_in">generate_prime</span>(<span class="number">1024</span>)</span><br><span class="line">q=libnum.<span class="built_in">generate_prime</span>(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">6</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">M=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,M) </span><br></pre></td></tr></table></figure>
</li>
<li><p>sageæ±‚è§£m</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">high_m = </span><br><span class="line">R.&lt;x&gt; = <span class="built_in">PolynomialRing</span>(<span class="built_in">Zmod</span>(n), implementation=<span class="string">&#x27;NTL&#x27;</span>)</span><br><span class="line">m = high_m + x</span><br><span class="line">M = <span class="built_in">m</span>((m^<span class="number">6</span> - c).<span class="built_in">small_roots</span>()[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(M))[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
</li>
<li><p>pythonè¿˜åŸm</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">M =</span><br><span class="line"><span class="built_in">print</span>(libnum.<span class="built_in">n2s</span>(M))</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Base64å˜è¡¨è§£å¯†"><a href="#Base64å˜è¡¨è§£å¯†" class="headerlink" title="Base64å˜è¡¨è§£å¯†"></a>Base64å˜è¡¨è§£å¯†</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"># åŸè¡¨</span><br><span class="line">origin = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"># å˜è¡¨</span><br><span class="line">base = <span class="string">&#x27;yzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/abcdefghijklmnopqrstuvwx&#x27;</span></span><br><span class="line"># å¯†æ–‡</span><br><span class="line">c = <span class="string">&#x27;1ovhXETgZUDgXFS=&#x27;</span></span><br><span class="line"># æ˜ å°„è¡¨</span><br><span class="line">table = str.<span class="built_in">maketrans</span>(base,origin)</span><br><span class="line"># æ˜æ–‡</span><br><span class="line">m = <span class="built_in">str</span>(base64.<span class="built_in">b64decode</span>(c.<span class="built_in">translate</span>(table)),encoding=(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<h2 id="SM4è§£å¯†"><a href="#SM4è§£å¯†" class="headerlink" title="SM4è§£å¯†"></a>SM4è§£å¯†</h2><ul>
<li>é¢˜ç›®éƒ¨åˆ†è§£å¯†æºç </li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from libnum <span class="keyword">import</span> s2n, n2s</span><br><span class="line">from pysm4 <span class="keyword">import</span> decrypt</span><br><span class="line">cipher = <span class="number">119384314703134531538573762305905297230</span></span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line">sm4_key = <span class="built_in">s2n</span>(b<span class="string">&quot;where_are_u_now?&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">n2s</span>(<span class="built_in">decrypt</span>(cipher, sm4_key)).<span class="built_in">decode</span>())</span><br></pre></td></tr></table></figure>

<h2 id="MD5åŠ å¯†"><a href="#MD5åŠ å¯†" class="headerlink" title="MD5åŠ å¯†"></a>MD5åŠ å¯†</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"># å¾…åŠ å¯†ä¿¡æ¯</span><br><span class="line">str = <span class="string">&#x27;this is a md5 test.&#x27;</span></span><br><span class="line"></span><br><span class="line"># åˆ›å»ºmd5å¯¹è±¡</span><br><span class="line">hl = hashlib.<span class="built_in">md5</span>()</span><br><span class="line">hl.<span class="built_in">update</span>(str.<span class="built_in">encode</span>(encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5åŠ å¯†å‰ä¸º ï¼š&#x27;</span> + str)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;MD5åŠ å¯†åä¸º ï¼š&#x27;</span> + hl.<span class="built_in">hexdigest</span>())</span><br></pre></td></tr></table></figure>

<h2 id="å‚æ•°æ³¨å…¥"><a href="#å‚æ•°æ³¨å…¥" class="headerlink" title="å‚æ•°æ³¨å…¥"></a>å‚æ•°æ³¨å…¥</h2><ul>
<li>hackgame2022 flagè‡ªåŠ¨æœº</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    HWND target = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–çª—å£å¥æŸ„</span></span><br><span class="line">    target = <span class="built_in">FindWindowW</span>(<span class="string">L&quot;flag è‡ªåŠ¨æœº&quot;</span>, <span class="string">L&quot;flag è‡ªåŠ¨æœº&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;error!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;0x%x&quot;</span>, target);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="built_in">PostMessageW</span>(target, <span class="number">0x111</span>, <span class="number">3</span>, <span class="number">114514</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CRC32è§£å¯†"><a href="#CRC32è§£å¯†" class="headerlink" title="CRC32è§£å¯†"></a>CRC32è§£å¯†</h2><ul>
<li>RoarCTF2019 polyre</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"># äº§ç”ŸCRC32æŸ¥è¡¨æ³•æ‰€ç”¨çš„è¡¨</span><br><span class="line"><span class="keyword">for</span> s in secret:</span><br><span class="line">    <span class="keyword">for</span> i in <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   #åˆ¤æ–­é¦–ä½æ­£è´Ÿ</span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s <span class="comment">//= 2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    # é˜²æ­¢è´Ÿå€¼é™¤<span class="number">2</span>ï¼Œæº¢å‡ºä¸ºæ­£å€¼</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      # è¾“å‡ºè¡¨</span><br><span class="line">    # è®¡ç®—CRC64</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h1 id="CR4åŠ å¯†"><a href="#CR4åŠ å¯†" class="headerlink" title="CR4åŠ å¯†"></a>CR4åŠ å¯†</h1><ul>
<li>å¯†é’¥é•¿åº¦å¯å˜ï¼ŒåŠ è§£å¯†åŒä¸€å¥—ä»£ç </li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> longULONG;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*åˆå§‹åŒ–å‡½æ•°*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_init</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">long</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> k[<span class="number">256</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">        k[i] = key[i % len];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        j = (j + s[i] + k[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*åŠ è§£å¯†*/</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *s, <span class="type">unsigned</span> <span class="type">char</span> *Data, <span class="type">unsigned</span> <span class="type">long</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp;</span><br><span class="line">    <span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; len; k++)</span><br><span class="line">    &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">        Data[k] ^= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> s[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;<span class="comment">//S-box</span></span><br><span class="line">    <span class="type">char</span> key[<span class="number">256</span>] = &#123;<span class="string">&quot;justfortest&quot;</span>&#125;;		</span><br><span class="line">    <span class="comment">//å¯†æ–‡åå…­è¿›åˆ¶å½¢å¼</span></span><br><span class="line">    <span class="type">int</span> pata[<span class="number">512</span>] = &#123;<span class="number">0x10</span>,<span class="number">0xa8</span>,<span class="number">0x1</span>,<span class="number">0x36</span>,<span class="number">0xa0</span>,<span class="number">0x48</span>,<span class="number">0x6a</span>,<span class="number">0xb6</span>,<span class="number">0xdb</span>,<span class="number">0xf1</span>,<span class="number">0x64</span>,<span class="number">0xad</span>,<span class="number">0x84</span>,<span class="number">0x59</span>,<span class="number">0x2</span>,<span class="number">0x9d</span>,<span class="number">0x8a</span>,<span class="number">0x54</span>,<span class="number">0x9e</span>,<span class="number">0xc2</span>,<span class="number">0x4d</span>,<span class="number">0x27</span>&#125;;</span><br><span class="line">    <span class="comment">//è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼</span></span><br><span class="line">    <span class="type">char</span> pData[<span class="number">512</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; pata[i]; i++)&#123;</span><br><span class="line">    	pData[i] = (<span class="type">char</span>)pata[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">rc4_init</span>(s, (<span class="type">unsigned</span> <span class="type">char</span>*)key, <span class="built_in">strlen</span>(key));<span class="comment">//å·²ç»å®Œæˆäº†åˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">rc4_crypt</span>(s, (<span class="type">unsigned</span> <span class="type">char</span>*)pData, <span class="built_in">strlen</span>(pData));<span class="comment">//crypt</span></span><br><span class="line">    <span class="comment">//out</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; pData[i]; i++)&#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;0x%02x,&quot;</span>,pData[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;å­—ç¬¦ä¸²æ ¼å¼ä¸ºï¼š\n%s&quot;</span>,pData);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Base64/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Base64/" class="post-title-link" itemprop="url">Base64</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:08:03" itemprop="dateCreated datePublished" datetime="2023-03-31T19:08:03+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:05:39" itemprop="dateModified" datetime="2023-04-01T10:05:39+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>ç»†çç¼–ç è¿‡ç¨‹</li>
</ul>
<hr>
<h3 id="ç¼–ç è¿‡ç¨‹"><a href="#ç¼–ç è¿‡ç¨‹" class="headerlink" title="ç¼–ç è¿‡ç¨‹"></a>ç¼–ç è¿‡ç¨‹</h3><ol>
<li>å°†ç›®æ ‡å­—ç¬¦ä¾ç…§ASCIIç è¡¨å˜ä¸ºçº¯äºŒè¿›åˆ¶</li>
<li>æŒ‰æ¯6ä½ä¸€ä¸ªå•å…ƒè¿›è¡Œé‡æ–°åˆ‡å‰²ï¼Œï¼ˆä¸å¤Ÿ6ä½çš„åœ°æ–¹è¡¥0ï¼‰</li>
<li>å¯¹ç…§base64ç¼–ç è¡¨ï¼Œç¼–ç å‡ºæ¯ä¸ªå•å…ƒæ‰€ä»£è¡¨çš„å­—ç¬¦</li>
</ol>
<h3 id="base64ç¼–ç è¡¨"><a href="#base64ç¼–ç è¡¨" class="headerlink" title="base64ç¼–ç è¡¨"></a>base64ç¼–ç è¡¨</h3><p><img src="https://s2.loli.net/2022/09/06/QiUuEKzCvZIFNDV.jpg" alt="v2-ff0ffbecbd68704bf1ddf8f7d53095b8_r.jpg"></p>
<h3 id="egï¼š"><a href="#egï¼š" class="headerlink" title="egï¼š"></a>egï¼š</h3><ul>
<li>ç›®æ ‡å­—ç¬¦ï¼šdlw</li>
<li>ç¬¬ä¸€æ­¥ï¼šè½¬å˜ä¸ºäºŒè¿›åˆ¶ä¸²</li>
</ul>
<blockquote>
<p>01100100(d) 01101100(l) 01110111(w)</p>
</blockquote>
<ul>
<li>ç¬¬äºŒæ­¥ï¼š6ä½åˆ‡å‰²</li>
</ul>
<blockquote>
<p>011001 | 000110 | 110001 | 110111</p>
</blockquote>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾æ¯ä¸€å•å…ƒå¯¹åº”çš„å­—ç¬¦ï¼Œé‡æ–°ç¼–ç </li>
</ul>
<blockquote>
<p>011001(Z) | 000110(G) | 110001(x) | 110111(3)</p>
</blockquote>
<ul>
<li>å¾—åˆ°ç»“æœï¼šZGx3</li>
</ul>
<h3 id="pythonç¼–ç "><a href="#pythonç¼–ç " class="headerlink" title="pythonç¼–ç "></a>pythonç¼–ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64encode(s.encode())</span><br><span class="line">print(t.decode())</span><br></pre></td></tr></table></figure>

<h3 id="pythonè§£ç "><a href="#pythonè§£ç " class="headerlink" title="pythonè§£ç "></a>pythonè§£ç </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">s = input()</span><br><span class="line">t = base64.b64decode(s.encode())</span><br><span class="line">print(t.decode())</span><br></pre></td></tr></table></figure>

<h3 id="Notice"><a href="#Notice" class="headerlink" title="Notice"></a>Notice</h3><ol>
<li>base64çš„ç‰¹å¾ä¹‹ä¸€ï¼šç»“æœä¸²é•¿åº¦ä¸€å®šä¸º4çš„å€æ•°</li>
<li>ä¸ºäº†è¡¥é½4å€çš„å•å…ƒï¼Œç¼–ç æ—¶å¯èƒ½ä¼šå‡ºç°æœ«å°¾nä¸ªå•å…ƒå…¨éƒ¨ä¸ºç©ºçš„æƒ…å†µï¼Œè¿™æ—¶å€™å°±ç”¨â€œ&#x3D;â€è¡¥é½ï¼Œè¿™ä¹Ÿæ˜¯è¯†åˆ«base64ç¼–ç çš„ä¸€ç§æ–¹å¼</li>
</ol>
<h4 id="æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€"><a href="#æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€" class="headerlink" title="æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€"></a>æ¯”å¦‚ä¸¤ä¸ªå­—ç¬¦â€œdlâ€</h4><ul>
<li>äºŒè¿›åˆ¶ï¼š01100100(d) 01101100(l)</li>
<li>åˆ‡å‰²ï¼š011001(Z)) | 000110(G) | 1100ï¼ˆè¡¥ä¸¤ä¸ª0ï¼‰(w) | ï¼ˆç©ºå•å…ƒï¼‰(&#x3D;)</li>
<li>ç»“æœï¼šZGw&#x3D;</li>
</ul>
<h3 id="æ¶‰åŠé¢˜ç›®"><a href="#æ¶‰åŠé¢˜ç›®" class="headerlink" title="æ¶‰åŠé¢˜ç›®"></a>æ¶‰åŠé¢˜ç›®</h3><ul>
<li>python-trade</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Crypto/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Crypto/" class="post-title-link" itemprop="url">Crypyo</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:06:13" itemprop="dateCreated datePublished" datetime="2023-03-31T19:06:13+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:13:04" itemprop="dateModified" datetime="2023-04-01T10:13:04+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Baseå®¶æ—"><a href="#Baseå®¶æ—" class="headerlink" title="Baseå®¶æ—"></a>Baseå®¶æ—</h2><h4 id="base16"><a href="#base16" class="headerlink" title="base16"></a>base16</h4><ul>
<li>16è¿›åˆ¶ï¼ŒåªåŒ…å«ï¼ˆ[0-9], [A-F]ï¼‰</li>
</ul>
<h4 id="base32"><a href="#base32" class="headerlink" title="base32"></a>base32</h4><ul>
<li>ï¼ˆ[A-Z],[2-7]ï¼‰,ä¸€èˆ¬æ¥è®²å¯†æ–‡å­—æ¯å¤šäºæ•°å­—ï¼Œè€Œä¸”æœ«å°¾æœ‰å¤šä¸ªç­‰å·</li>
</ul>
<h4 id="base58"><a href="#base58" class="headerlink" title="base58"></a>base58</h4><ul>
<li>ç»“å°¾æ— ç­‰å·</li>
</ul>
<h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><ul>
<li>ï¼ˆ[A-Z],[a-z],[0-9]ï¼‰ï¼Œæœ«å°¾æœ‰1åˆ°2ä¸ªç­‰å·</li>
<li>8ä½å˜6ä½é‡ç»„</li>
</ul>
<h4 id="base85"><a href="#base85" class="headerlink" title="base85"></a>base85</h4><ul>
<li>ç­‰å·å¯èƒ½å‡ºç°åœ¨å¯†æ–‡ä¸­é—´</li>
</ul>
<h4 id="base91"><a href="#base91" class="headerlink" title="base91"></a>base91</h4><ul>
<li>ï¼ˆ[0-9]ï¼Œ[a-z]ï¼Œ[A-Z],[!#$%&amp;()*+,.&#x2F;:;&lt;&#x3D;&gt;?@[]^_&#96;{|}~â€]ï¼‰</li>
</ul>
<h4 id="base100"><a href="#base100" class="headerlink" title="base100"></a>base100</h4><ul>
<li>å¯†æ–‡ä¸ºemjio</li>
</ul>
<h2 id="å¹‚æ•°åŠ å¯†"><a href="#å¹‚æ•°åŠ å¯†" class="headerlink" title="å¹‚æ•°åŠ å¯†"></a>å¹‚æ•°åŠ å¯†</h2><h3 id="åŠ å¯†æ–¹æ³•"><a href="#åŠ å¯†æ–¹æ³•" class="headerlink" title="åŠ å¯†æ–¹æ³•"></a>åŠ å¯†æ–¹æ³•</h3><ul>
<li>ç”±äºæ¯ä¸€ä¸ªæ•°éƒ½å¯ä»¥å˜æˆå½¢å¼ä¸ºâ€2a+2b+2câ€¦.â€çš„è¡¨è¾¾å¼<br>æ‰€ä»¥æˆ‘ä»¬ç”¨å¯¹åº”â€abcâ€¦â€æ•°å­—ä¸²æ¥ä»£è¡¨è¿™ä¸ªæ•°</li>
<li>ä¾‹å¦‚<br>5 &#x3D; 20+22ï¼Œå³å¯è¡¨ç¤ºä¸º02<br>19 &#x3D; 20+21+24ï¼Œå³014</li>
</ul>
<h3 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h3><blockquote>
<p>8842101220480224404014224202480122</p>
</blockquote>
<ul>
<li>æ˜¯8ä½å¤§å†™å­—æ¯</li>
<li>é‡‡ç”¨å¹‚æ•°åŠ å¯†</li>
</ul>
<h3 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h3><ul>
<li><p>è”æƒ³8ä½å­—æ¯å’Œ8ä¸ª0çš„å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä»¥0ä¸ºåˆ†éš”ç¬¦<br>æ‹†åˆ†åå¯ä»¥å¾—åˆ°ï¼š</p>
<blockquote>
<p>88421 122 48 2244 4 142242 248 122</p>
</blockquote>
</li>
<li><p>è§‚å¯Ÿå‘ç°æ¯ä¸ªæ•°å­—éƒ½æ˜¯2çš„å€æ•°ï¼Œæ¨æ–­å•ä¸ªæ•°å­—è¡¨ç¤ºçš„å°±æ˜¯â€2aâ€œï¼Œæ‰€ä»¥å°†æ¯ä¸€æ®µæ•°å­—ç›´æ¥æ±‚å’Œ</p>
</li>
<li><p>ä¸Šè„šæœ¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int main(void)</span><br><span class="line">&#123;</span><br><span class="line">	string s = &quot;88421 122 48 2244 4 142242 248 122 &quot;; </span><br><span class="line">	int sum = 0;</span><br><span class="line">	for(int i = 0; i &lt; s.length(); i++)&#123;</span><br><span class="line">		if(s[i] == &#x27; &#x27;)&#123;</span><br><span class="line">			cout &lt;&lt;char(sum+&#x27;A&#x27;-1);</span><br><span class="line">			sum = 0;</span><br><span class="line">		&#125;</span><br><span class="line">		else&#123;</span><br><span class="line">			sum += (s[i]-&#x27;0&#x27;);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¾—åˆ°flagï¼š</p>
<blockquote>
<p>cyberpace{WELLDONE}</p>
</blockquote>
</li>
</ul>
<h2 id="çŒªåœˆå¯†ç "><a href="#çŒªåœˆå¯†ç " class="headerlink" title="çŒªåœˆå¯†ç "></a>çŒªåœˆå¯†ç </h2><ul>
<li><p>ç‰¹å¾ï¼š</p>
<p><img src="https://s2.loli.net/2022/11/10/NcQI8HopdEwVzy9.jpg" alt="Crypto_Pig.jpg"></p>
</li>
<li><p>è§£å¯†ç½‘ç«™ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://xiao84.com/tools/103177.html">çŒªåœˆå¯†ç -åœ¨çº¿è§£å¯†åŠ å¯†å·¥å…· (xiao84.com)</a></li>
</ul>
</li>
</ul>
<h2 id="emjio-AES"><a href="#emjio-AES" class="headerlink" title="emjio-AES"></a>emjio-AES</h2><ul>
<li>åŠ å¯†è¿‡ç¨‹å°±æ˜¯å°†ä¸€æ®µå­—ç¬¦ä¸²ç”¨keyå’Œrotationè¿›è¡ŒAESåŠ å¯†ï¼Œç„¶åå°†è¾“å‡ºçš„base64ç ç”¨è¡¨æƒ…åŒ…æ›¿æ¢ï¼Œç‰¹å¾åªèƒ½é çŒœå’Œhintäº†</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/">emoji-aes (aghorler.github.io)</a></li>
</ul>
</li>
<li>æ¶‰åŠé¢˜ç›®<ul>
<li>ISCTF2022 å¯çˆ±çš„emjio</li>
</ul>
</li>
</ul>
<h2 id="ä½›æ›°åŠ å¯†"><a href="#ä½›æ›°åŠ å¯†" class="headerlink" title="ä½›æ›°åŠ å¯†"></a>ä½›æ›°åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šâ€œè«¸éš¸æ¯˜åƒ§é™æ¯˜å½è«¸é™€æ¯˜æ‘©æ¯˜éš¸åƒ§æ¯˜ç¼½è–©æ¯˜é¡˜å¿ƒæ¯˜å©†æ¯˜åš´å½Œæ¯˜å¿µæ¯˜å¦‚æ¯˜å›‘æ¯˜â€ ä¸€å †å¤æ€ªæ–‡å­—</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a target="_blank" rel="noopener" href="http://hi.pcmoe.net/Buddha.html">æ–°çº¦ä½›è®ºç¦…&#x2F;ä½›æ›°åŠ å¯† - PcMoe!</a></li>
</ul>
</li>
</ul>
<h2 id="å¤©å¹²åœ°æ”¯åŠ å¯†"><a href="#å¤©å¹²åœ°æ”¯åŠ å¯†" class="headerlink" title="å¤©å¹²åœ°æ”¯åŠ å¯†"></a>å¤©å¹²åœ°æ”¯åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šåˆ©ç”¨çºªå¹´æ³•å¯¹åº”åŠ å¯†æ•°å­—</li>
<li>è§£å¯†ï¼šæŸ¥è¡¨</li>
<li>æ¶‰åŠé¢˜ç›®ï¼š<ul>
<li>[MRCTF]å¤©å¹²åœ°æ”¯+ç”²å­</li>
</ul>
</li>
</ul>
<h2 id="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†"><a href="#ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†" class="headerlink" title="ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†"></a>ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†</h2><ul>
<li>ç‰¹å¾ï¼šé¡¾åæ€ä¹‰</li>
<li>è§£å¯†ç½‘ç«™ï¼š<ul>
<li><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=850">ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚åŠ å¯†&#x2F;è§£å¯† - ä¸€ä¸ªå·¥å…·ç®± - å¥½ç”¨çš„åœ¨çº¿å·¥å…·éƒ½åœ¨è¿™é‡Œï¼ (atoolbox.net)</a></li>
</ul>
</li>
</ul>
<h2 id="jsfuckç¼–ç "><a href="#jsfuckç¼–ç " class="headerlink" title="jsfuckç¼–ç "></a>jsfuckç¼–ç </h2><ul>
<li><p>ç‰¹å¾ï¼šç”±()+ []! å…­ä¸ªå­—ç¬¦ç»„æˆç¼–ç </p>
</li>
<li><p>ä¸¾ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">false	==&gt;	![]</span><br><span class="line">true	=&gt;	!![]</span><br><span class="line">undefined	=&gt;	[][[]]</span><br><span class="line">NaN	=&gt;	+[![]]</span><br><span class="line">0	=&gt;	+[]</span><br><span class="line">1	=&gt;	+!+[]</span><br><span class="line">2	=&gt;	!+[]+!+[]</span><br><span class="line">10	=&gt;	[+!+[]]+[+[]]</span><br><span class="line">Array	=&gt;	[]</span><br><span class="line">Number	=&gt;	+[]</span><br><span class="line">String	=&gt;	[]+[]</span><br><span class="line">Boolean	=&gt;	![]</span><br><span class="line">Function	=&gt;	[][&quot;filter&quot;]</span><br><span class="line">eval	=&gt;	[][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()</span><br><span class="line">window	=&gt;	[][&quot;filter&quot;][&quot;constructor&quot;](&quot;return this&quot;)()</span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†ç½‘ç«™ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.bugku.com/tools/jsfuck">https://www.bugku.com/tools/jsfuck</a></li>
<li><a target="_blank" rel="noopener" href="https://www.dejs.vip/encry_decry/jsfuck.html">jsfuckåŠ å¯†&#x2F;è§£å¯† - dejs.vip</a></li>
</ul>
</li>
<li><p>æ¶‰åŠé¢˜ç›®ï¼š</p>
<ul>
<li>buuctf - è¿™æ˜¯ä»€ä¹ˆ</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Flat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Flat/" class="post-title-link" itemprop="url">Deplanarization problem</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:04:58" itemprop="dateCreated datePublished" datetime="2023-03-31T19:04:58+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:11:07" itemprop="dateModified" datetime="2023-04-01T10:11:07+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="è§£é¢˜æµç¨‹"><a href="#è§£é¢˜æµç¨‹" class="headerlink" title="è§£é¢˜æµç¨‹"></a>è§£é¢˜æµç¨‹</h2><ol>
<li>æŸ¥å£³IDA</li>
<li>è„šæœ¬å»å¹³å¦åŒ–</li>
<li>IDAè„šæœ¬å»æ··æ·†</li>
<li>CRC32è¯†åˆ«</li>
<li>è§£å¯†è„šæœ¬</li>
</ol>
<h2 id="è„šæœ¬é›†"><a href="#è„šæœ¬é›†" class="headerlink" title="è„šæœ¬é›†"></a>è„šæœ¬é›†</h2><ul>
<li><p>å»å¹³å¦åŒ–è„šæœ¬</p>
<ul>
<li><p>å‘½ä»¤ï¼š</p>
<blockquote>
<p>python deflat.py attachment 0x400620</p>
</blockquote>
</li>
<li><p>deflat</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> pyvex</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">&#x27;C:\\Users\\du\\Desktop\\CTFTools\\Flat\\am_graph&#x27;</span>)  <span class="comment">## am_graphè·¯å¾„</span></span><br><span class="line"><span class="keyword">import</span> am_graph</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.getLogger(<span class="string">&#x27;angr.state_plugins.symbolic_memory&#x27;</span>).setLevel(logging.ERROR)</span><br><span class="line"><span class="comment"># logging.getLogger(&#x27;angr.sim_manager&#x27;).setLevel(logging.DEBUG)</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_relevant_nop_nodes</span>(<span class="params">supergraph</span>):</span><br><span class="line">    <span class="keyword">global</span> pre_dispatcher_node, prologue_node, retn_node</span><br><span class="line">    <span class="comment"># relevant_nodes = list(supergraph.predecessors(pre_dispatcher_node))</span></span><br><span class="line">    relevant_nodes = []</span><br><span class="line">    nop_nodes = []</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.has_edge(node, pre_dispatcher_node) <span class="keyword">and</span> node.size &gt; <span class="number">8</span>:</span><br><span class="line">            <span class="comment"># <span class="doctag">XXX:</span> use node.size is faster than to create a block </span></span><br><span class="line">            relevant_nodes.append(node)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> node.addr <span class="keyword">in</span> ( prologue_node.addr, retn_node.addr, pre_dispatcher_node.addr):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nop_nodes.append(node)</span><br><span class="line">    <span class="keyword">return</span> relevant_nodes, nop_nodes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">symbolic_execution</span>(<span class="params">start_addr, hook_addr=<span class="literal">None</span>, modify=<span class="literal">None</span>, inspect=<span class="literal">False</span></span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">retn_procedure</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> project</span><br><span class="line">        ip = state.se.<span class="built_in">eval</span>(state.regs.ip)</span><br><span class="line">        project.unhook(ip)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">statement_inspect</span>(<span class="params">state</span>):</span><br><span class="line">        <span class="keyword">global</span> modify_value</span><br><span class="line">        expressions = <span class="built_in">list</span>(state.scratch.irsb.statements[state.inspect.statement].expressions)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(expressions) != <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">isinstance</span>(expressions[<span class="number">0</span>], pyvex.expr.ITE):</span><br><span class="line">            state.scratch.temps[expressions[<span class="number">0</span>].cond.tmp] = modify_value</span><br><span class="line">            state.inspect._breakpoints[<span class="string">&#x27;statement&#x27;</span>] = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> project, relevant_block_addrs, modify_value</span><br><span class="line">    <span class="keyword">if</span> hook_addr != <span class="literal">None</span>:</span><br><span class="line">        project.hook(hook_addr, retn_procedure, length=<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> modify != <span class="literal">None</span>:</span><br><span class="line">        modify_value = modify</span><br><span class="line">    state = project.factory.blank_state(addr=start_addr, remove_options=&#123;angr.sim_options.LAZY_SOLVES&#125;)</span><br><span class="line">    <span class="keyword">if</span> inspect:</span><br><span class="line">        state.inspect.b(<span class="string">&#x27;statement&#x27;</span>, when=angr.state_plugins.inspect.BP_BEFORE, action=statement_inspect)</span><br><span class="line">    sm = project.factory.simulation_manager(state)</span><br><span class="line">    sm.step()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(sm.active) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> active_state <span class="keyword">in</span> sm.active:</span><br><span class="line">            <span class="keyword">if</span> active_state.addr <span class="keyword">in</span> relevant_block_addrs:</span><br><span class="line">                <span class="keyword">return</span> active_state.addr</span><br><span class="line">        sm.step()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_nop</span>(<span class="params">data, start_addr, length</span>):</span><br><span class="line">    <span class="keyword">global</span> opcode</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length):</span><br><span class="line">        data[start_addr + i] = <span class="built_in">ord</span>(opcode[<span class="string">&#x27;nop&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill_jmp_offset</span>(<span class="params">data, start, offset</span>):</span><br><span class="line">    jmp_offset = struct.pack(<span class="string">&#x27;&lt;i&#x27;</span>, offset)  <span class="comment"># bytes</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        data[start + i] = jmp_offset[i]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">patch_byte</span>(<span class="params">data, offset, value</span>):</span><br><span class="line">    <span class="comment"># operate on bytearray, not str</span></span><br><span class="line">    data[offset] = <span class="built_in">ord</span>(value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: python deflat.py filename function_address(hex)&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    opcode = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;ae&#x27;</span>: <span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;be&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;c&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;e&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;z&#x27;</span>:<span class="string">&#x27;\x84&#x27;</span>, <span class="string">&#x27;g&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, </span><br><span class="line">              <span class="string">&#x27;ge&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;l&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;le&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;na&#x27;</span>:<span class="string">&#x27;\x86&#x27;</span>, <span class="string">&#x27;nae&#x27;</span>:<span class="string">&#x27;\x82&#x27;</span>, <span class="string">&#x27;nb&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>, <span class="string">&#x27;nbe&#x27;</span>:<span class="string">&#x27;\x87&#x27;</span>, <span class="string">&#x27;nc&#x27;</span>:<span class="string">&#x27;\x83&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;ne&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;ng&#x27;</span>:<span class="string">&#x27;\x8E&#x27;</span>, <span class="string">&#x27;nge&#x27;</span>:<span class="string">&#x27;\x8C&#x27;</span>, <span class="string">&#x27;nl&#x27;</span>:<span class="string">&#x27;\x8D&#x27;</span>, <span class="string">&#x27;nle&#x27;</span>:<span class="string">&#x27;\x8F&#x27;</span>, <span class="string">&#x27;no&#x27;</span>:<span class="string">&#x27;\x81&#x27;</span>, <span class="string">&#x27;np&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;ns&#x27;</span>:<span class="string">&#x27;\x89&#x27;</span>,</span><br><span class="line">              <span class="string">&#x27;nz&#x27;</span>:<span class="string">&#x27;\x85&#x27;</span>, <span class="string">&#x27;o&#x27;</span>:<span class="string">&#x27;\x80&#x27;</span>, <span class="string">&#x27;p&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;pe&#x27;</span>:<span class="string">&#x27;\x8A&#x27;</span>, <span class="string">&#x27;po&#x27;</span>:<span class="string">&#x27;\x8B&#x27;</span>, <span class="string">&#x27;s&#x27;</span>:<span class="string">&#x27;\x88&#x27;</span>, <span class="string">&#x27;nop&#x27;</span>:<span class="string">&#x27;\x90&#x27;</span>, <span class="string">&#x27;jmp&#x27;</span>:<span class="string">&#x27;\xE9&#x27;</span>, <span class="string">&#x27;j&#x27;</span>:<span class="string">&#x27;\x0F&#x27;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">    start = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    project = angr.Project(filename, load_options=&#123;<span class="string">&#x27;auto_load_libs&#x27;</span>: <span class="literal">False</span>&#125;)</span><br><span class="line">    cfg = project.analyses.CFGFast(normalize=<span class="literal">True</span>)  <span class="comment"># do normalize to avoid overlapping blocks</span></span><br><span class="line">    target_function = cfg.functions.get(start)</span><br><span class="line">    <span class="comment"># A super transition graph is a graph that looks like IDA Pro&#x27;s CFG</span></span><br><span class="line">    supergraph = am_graph.to_supergraph(target_function.transition_graph)</span><br><span class="line"></span><br><span class="line">    base_addr = project.loader.main_object.mapped_base &gt;&gt; <span class="number">12</span> &lt;&lt; <span class="number">12</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get prologue_node and retn_node</span></span><br><span class="line">    prologue_node = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.nodes():</span><br><span class="line">        <span class="keyword">if</span> supergraph.in_degree(node) == <span class="number">0</span>:</span><br><span class="line">            prologue_node = node</span><br><span class="line">        <span class="keyword">if</span> supergraph.out_degree(node) == <span class="number">0</span>:</span><br><span class="line">            retn_node = node</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> prologue_node <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> prologue_node.addr != start:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Something must be wrong...&quot;</span>)</span><br><span class="line">        sys.exit(-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    main_dispatcher_node = <span class="built_in">list</span>(supergraph.successors(prologue_node))[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> supergraph.predecessors(main_dispatcher_node):</span><br><span class="line">        <span class="keyword">if</span> node.addr != prologue_node.addr:</span><br><span class="line">            pre_dispatcher_node = node</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    relevant_nodes, nop_nodes = get_relevant_nop_nodes(supergraph)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************relevant blocks************************&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;prologue: %#x&#x27;</span> % start)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;main_dispatcher: %#x&#x27;</span> % main_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;pre_dispatcher: %#x&#x27;</span> % pre_dispatcher_node.addr)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;retn: %#x&#x27;</span> % retn_node.addr)</span><br><span class="line">    relevant_block_addrs = [node.addr <span class="keyword">for</span> node <span class="keyword">in</span> relevant_nodes]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;relevant_blocks:&#x27;</span>, [<span class="built_in">hex</span>(addr) <span class="keyword">for</span> addr <span class="keyword">in</span> relevant_block_addrs])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;*******************symbolic execution*********************&#x27;</span>)</span><br><span class="line">    relevants = relevant_nodes</span><br><span class="line">    relevants.append(prologue_node)</span><br><span class="line">    relevants_without_retn = <span class="built_in">list</span>(relevants)</span><br><span class="line">    relevants.append(retn_node)</span><br><span class="line">    relevant_block_addrs.extend([prologue_node.addr, retn_node.addr])</span><br><span class="line"></span><br><span class="line">    flow = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    modify_value = <span class="literal">None</span></span><br><span class="line">    patch_instrs = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> relevant <span class="keyword">in</span> relevants_without_retn:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;-------------------dse %#x---------------------&#x27;</span> % relevant.addr)</span><br><span class="line">        block = project.factory.block(relevant.addr, size=relevant.size)</span><br><span class="line">        has_branches = <span class="literal">False</span></span><br><span class="line">        hook_addr = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">for</span> ins <span class="keyword">in</span> block.capstone.insns:</span><br><span class="line">            <span class="keyword">if</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;cmov&#x27;</span>):</span><br><span class="line">                patch_instrs[relevant] = ins</span><br><span class="line">                has_branches = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> ins.insn.mnemonic.startswith(<span class="string">&#x27;call&#x27;</span>):</span><br><span class="line">                hook_addr = ins.insn.address</span><br><span class="line">        <span class="keyword">if</span> has_branches:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">1</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr, claripy.BVV(<span class="number">0</span>, <span class="number">1</span>), <span class="literal">True</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flow[relevant].append(symbolic_execution(relevant.addr, hook_addr))</span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************flow******************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % k.addr, [<span class="built_in">hex</span>(child) <span class="keyword">for</span> child <span class="keyword">in</span> v])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print retn_node flow. Actually, it&#x27;s [].</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%#x: &#x27;</span> % retn_node.addr, [])</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;************************patch*****************************&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> origin:</span><br><span class="line">        <span class="comment"># Attention: can&#x27;t transform to str by calling decode() directly. so use bytearray instead.</span></span><br><span class="line">        origin_data = <span class="built_in">bytearray</span>(origin.read())</span><br><span class="line">        origin_data_len = <span class="built_in">len</span>(origin_data)</span><br><span class="line"></span><br><span class="line">    recovery_file = filename + <span class="string">&#x27;_recovered&#x27;</span></span><br><span class="line">    recovery = <span class="built_in">open</span>(recovery_file, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># patch irrelevant blocks</span></span><br><span class="line">    <span class="keyword">for</span> nop_node <span class="keyword">in</span> nop_nodes:</span><br><span class="line">        fill_nop(origin_data, nop_node.addr - base_addr, nop_node.size)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># remove unnecessary control flows</span></span><br><span class="line">    <span class="keyword">for</span> parent, childs <span class="keyword">in</span> flow.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(childs) == <span class="number">1</span>:</span><br><span class="line">            parent_block = project.factory.block(parent.addr, size=parent.size)</span><br><span class="line">            last_instr = parent_block.capstone.insns[-<span class="number">1</span>]</span><br><span class="line">            file_offset = last_instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch the last jmp instruction</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            file_offset += <span class="number">1</span></span><br><span class="line">            fill_nop(origin_data, file_offset, last_instr.size - <span class="number">1</span>)</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset, childs[<span class="number">0</span>] - last_instr.address - <span class="number">5</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            instr = patch_instrs[parent]</span><br><span class="line">            file_offset = instr.address - base_addr</span><br><span class="line">            <span class="comment"># patch instructions starting from `cmovx` to the end of block</span></span><br><span class="line">            fill_nop(origin_data, file_offset, parent.addr + parent.size - base_addr - file_offset)</span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;j&#x27;</span>])</span><br><span class="line">            patch_byte(origin_data, file_offset + <span class="number">1</span>, opcode[instr.mnemonic[<span class="number">4</span>:]])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">2</span>, childs[<span class="number">0</span>] - instr.address - <span class="number">6</span>)</span><br><span class="line">            file_offset += <span class="number">6</span></span><br><span class="line">            patch_byte(origin_data, file_offset, opcode[<span class="string">&#x27;jmp&#x27;</span>])</span><br><span class="line">            fill_jmp_offset(origin_data, file_offset + <span class="number">1</span>, childs[<span class="number">1</span>] - (instr.address + <span class="number">6</span>) - <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(origin_data) == origin_data_len, <span class="string">&quot;Error: size of data changed!!!&quot;</span></span><br><span class="line">    recovery.write(origin_data)</span><br><span class="line">    recovery.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successful! The recovered file: %s&#x27;</span> % recovery_file)</span><br></pre></td></tr></table></figure>
</li>
<li><p>am_graph</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> networkx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> angr.knowledge_plugins <span class="keyword">import</span> Function</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grouper</span>(<span class="params">iterable, n, fillvalue=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;Collect data into fixed-length chunks or blocks&quot;</span></span><br><span class="line">    args = [<span class="built_in">iter</span>(iterable)] * n</span><br><span class="line">    <span class="keyword">return</span> itertools.izip_longest(*args, fillvalue=fillvalue)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_supergraph</span>(<span class="params">transition_graph</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Convert transition graph of a function to a super transition graph. A super transition graph is a graph that looks</span></span><br><span class="line"><span class="string">    like IDA Pro&#x27;s CFG, where calls to returning functions do not terminate basic blocks.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param networkx.DiGraph transition_graph: The transition graph.</span></span><br><span class="line"><span class="string">    :return: A converted super transition graph</span></span><br><span class="line"><span class="string">    :rtype networkx.DiGraph</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># make a copy of the graph</span></span><br><span class="line">    transition_graph = networkx.DiGraph(transition_graph)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># remove all edges that transitions to outside</span></span><br><span class="line">    <span class="keyword">for</span> src, dst, data <span class="keyword">in</span> <span class="built_in">list</span>(transition_graph.edges(data=<span class="literal">True</span>)):</span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>) <span class="keyword">and</span> data.get(<span class="string">&#x27;outside&#x27;</span>, <span class="literal">False</span>) <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">            transition_graph.remove_edge(src, dst)</span><br><span class="line">        <span class="keyword">if</span> transition_graph.in_degree(dst) == <span class="number">0</span>:</span><br><span class="line">            transition_graph.remove_node(dst)</span><br><span class="line"></span><br><span class="line">    edges_to_shrink = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Find all edges to remove in the super graph</span></span><br><span class="line">    <span class="keyword">for</span> src <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line">        edges = transition_graph[src]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># there are two types of edges we want to remove:</span></span><br><span class="line">        <span class="comment"># - call or fakerets, since we do not want blocks to break at calls</span></span><br><span class="line">        <span class="comment"># - boring jumps that directly transfer the control to the block immediately after the current block. this is</span></span><br><span class="line">        <span class="comment">#   usually caused by how VEX breaks down basic blocks, which happens very often in MIPS</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(edges) == <span class="number">1</span> <span class="keyword">and</span> src.addr + src.size == <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys())).addr:</span><br><span class="line">            dst = <span class="built_in">next</span>(<span class="built_in">iter</span>(edges.keys()))</span><br><span class="line">            dst_in_edges = transition_graph.in_edges(dst)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(dst_in_edges) == <span class="number">1</span>:</span><br><span class="line">                edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;call&#x27;</span>) <span class="keyword">for</span> data <span class="keyword">in</span> edges.values())):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> edges.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;fake_return&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">iter</span>(<span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;fake_return&#x27;</span>, <span class="string">&#x27;return_from_call&#x27;</span>)</span><br><span class="line">                            <span class="keyword">for</span> _, _, data <span class="keyword">in</span> transition_graph.in_edges(dst, data=<span class="literal">True</span>))):</span><br><span class="line">                    edges_to_shrink.add((src, dst))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create the super graph</span></span><br><span class="line">    super_graph = networkx.DiGraph()</span><br><span class="line"></span><br><span class="line">    supernodes_map = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function_nodes = <span class="built_in">set</span>()  <span class="comment"># it will be traversed after all other nodes are added into the supergraph</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> transition_graph.nodes():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(node, Function):</span><br><span class="line">            function_nodes.add(node)</span><br><span class="line">            <span class="comment"># don&#x27;t put functions into the supergraph</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        dests_and_data = transition_graph[node]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># make a super node</span></span><br><span class="line">        <span class="keyword">if</span> node <span class="keyword">in</span> supernodes_map:</span><br><span class="line">            src_supernode = supernodes_map[node]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            src_supernode = SuperCFGNode.from_cfgnode(node)</span><br><span class="line">            supernodes_map[node] = src_supernode</span><br><span class="line">            <span class="comment"># insert it into the graph</span></span><br><span class="line">            super_graph.add_node(src_supernode)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> dests_and_data:</span><br><span class="line">            <span class="comment"># might be an isolated node</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Take src_supernode off the graph since we might modify it</span></span><br><span class="line">        <span class="keyword">if</span> src_supernode <span class="keyword">in</span> super_graph:</span><br><span class="line">            existing_in_edges = <span class="built_in">list</span>(super_graph.in_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            existing_out_edges = <span class="built_in">list</span>(super_graph.out_edges(src_supernode, data=<span class="literal">True</span>))</span><br><span class="line">            super_graph.remove_node(src_supernode)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            existing_in_edges = [ ]</span><br><span class="line">            existing_out_edges = [ ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dst, data <span class="keyword">in</span> dests_and_data.items():</span><br><span class="line"></span><br><span class="line">            edge = (node, dst)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> edge <span class="keyword">in</span> edges_to_shrink:</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">                src_supernode.insert_cfgnode(dst)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># update supernodes map</span></span><br><span class="line">                supernodes_map[dst] = src_supernode</span><br><span class="line"></span><br><span class="line">                <span class="comment"># merge the other supernode</span></span><br><span class="line">                <span class="keyword">if</span> dst_supernode <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                    src_supernode.merge(dst_supernode)</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> src <span class="keyword">in</span> dst_supernode.cfg_nodes:</span><br><span class="line">                        supernodes_map[src] = src_supernode</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all out edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> dst_, data_ <span class="keyword">in</span> super_graph[dst_supernode].items():</span><br><span class="line">                        super_graph.add_edge(src_supernode, dst_, **data_)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># link all in edges of dst_supernode to src_supernode</span></span><br><span class="line">                    <span class="keyword">for</span> src_, _, data_ <span class="keyword">in</span> super_graph.in_edges(dst_supernode, data=<span class="literal">True</span>):</span><br><span class="line">                        super_graph.add_edge(src_, src_supernode, **data_)</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> data_[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data_ <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data_):</span><br><span class="line">                                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                                <span class="keyword">continue</span></span><br><span class="line">                            src_supernode.register_out_branch(data_[<span class="string">&#x27;ins_addr&#x27;</span>], data_[<span class="string">&#x27;stmt_idx&#x27;</span>], data_[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                              dst_supernode.addr</span><br><span class="line">                                                              )</span><br><span class="line"></span><br><span class="line">                    super_graph.remove_node(dst_supernode)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(dst, Function):</span><br><span class="line">                    <span class="comment"># skip all functions</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># make a super node</span></span><br><span class="line">                <span class="keyword">if</span> dst <span class="keyword">in</span> supernodes_map:</span><br><span class="line">                    dst_supernode = supernodes_map[dst]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dst_supernode = SuperCFGNode.from_cfgnode(dst)</span><br><span class="line">                    supernodes_map[dst] = dst_supernode</span><br><span class="line"></span><br><span class="line">                super_graph.add_edge(src_supernode, dst_supernode, **data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;type&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> data[<span class="string">&#x27;type&#x27;</span>] <span class="keyword">in</span> (<span class="string">&#x27;transition&#x27;</span>, <span class="string">&#x27;exception&#x27;</span>):</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                        <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                        <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    src_supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>],</span><br><span class="line">                                                      dst_supernode.addr</span><br><span class="line">                                                      )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># add back the node (in case there are no edges)</span></span><br><span class="line">        super_graph.add_node(src_supernode)</span><br><span class="line">        <span class="comment"># add back the old edges</span></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> existing_in_edges:</span><br><span class="line">            super_graph.add_edge(src, src_supernode, **data)</span><br><span class="line">        <span class="keyword">for</span> _, dst, data <span class="keyword">in</span> existing_out_edges:</span><br><span class="line">            super_graph.add_edge(src_supernode, dst, **data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> node <span class="keyword">in</span> function_nodes:</span><br><span class="line">        in_edges = transition_graph.in_edges(node, data=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> src, _, data <span class="keyword">in</span> in_edges:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;ins_addr&#x27;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&#x27;stmt_idx&#x27;</span> <span class="keyword">in</span> data):</span><br><span class="line">                <span class="comment"># this is a hack to work around the issue in Function.normalize() where ins_addr and</span></span><br><span class="line">                <span class="comment"># stmt_idx weren&#x27;t properly set onto edges</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            supernode = supernodes_map[src]</span><br><span class="line">            supernode.register_out_branch(data[<span class="string">&#x27;ins_addr&#x27;</span>], data[<span class="string">&#x27;stmt_idx&#x27;</span>], data[<span class="string">&#x27;type&#x27;</span>], node.addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> super_graph</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OutBranch</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, ins_addr, stmt_idx, branch_type</span>):</span><br><span class="line">        self.ins_addr = ins_addr</span><br><span class="line">        self.stmt_idx = stmt_idx</span><br><span class="line">        self.<span class="built_in">type</span> = branch_type</span><br><span class="line"></span><br><span class="line">        self.targets = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.ins_addr <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at None, type %s&gt;&quot;</span> % self.<span class="built_in">type</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;OutBranch at %#x, type %s&gt;&quot;</span> % (self.ins_addr, self.<span class="built_in">type</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_target</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.targets.add(addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge with the other OutBranch descriptor.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param OutBranch other: The other item to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> self.ins_addr == other.ins_addr</span><br><span class="line">        <span class="keyword">assert</span> self.<span class="built_in">type</span> == other.<span class="built_in">type</span></span><br><span class="line"></span><br><span class="line">        o = self.copy()</span><br><span class="line">        o.targets |= other.targets</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">copy</span>(<span class="params">self</span>):</span><br><span class="line">        o = OutBranch(self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>)</span><br><span class="line">        o.targets = self.targets.copy()</span><br><span class="line">        <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, OutBranch):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.ins_addr == other.ins_addr <span class="keyword">and</span> \</span><br><span class="line">               self.stmt_idx == other.stmt_idx <span class="keyword">and</span> \</span><br><span class="line">               self.<span class="built_in">type</span> == other.<span class="built_in">type</span> <span class="keyword">and</span> \</span><br><span class="line">               self.targets == other.targets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((self.ins_addr, self.stmt_idx, self.<span class="built_in">type</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SuperCFGNode</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, addr</span>):</span><br><span class="line">        self.addr = addr</span><br><span class="line"></span><br><span class="line">        self.cfg_nodes = [ ]</span><br><span class="line"></span><br><span class="line">        self.out_branches = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sum</span>(node.size <span class="keyword">for</span> node <span class="keyword">in</span> self.cfg_nodes)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">from_cfgnode</span>(<span class="params">cls, cfg_node</span>):</span><br><span class="line">        s = cls(cfg_node.addr)</span><br><span class="line"></span><br><span class="line">        s.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert_cfgnode</span>(<span class="params">self, cfg_node</span>):</span><br><span class="line">        <span class="comment"># <span class="doctag">TODO:</span> Make it binary search/insertion</span></span><br><span class="line">        <span class="keyword">for</span> i, n <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.cfg_nodes):</span><br><span class="line">            <span class="keyword">if</span> cfg_node.addr &lt; n.addr:</span><br><span class="line">                <span class="comment"># insert before n</span></span><br><span class="line">                self.cfg_nodes.insert(i, cfg_node)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> cfg_node.addr == n.addr:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cfg_nodes.append(cfg_node)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update addr</span></span><br><span class="line">        self.addr = self.cfg_nodes[<span class="number">0</span>].addr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">register_out_branch</span>(<span class="params">self, ins_addr, stmt_idx, branch_type, target_addr</span>):</span><br><span class="line">        <span class="keyword">if</span> ins_addr <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches <span class="keyword">or</span> stmt_idx <span class="keyword">not</span> <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">            self.out_branches[ins_addr][stmt_idx] = OutBranch(ins_addr, stmt_idx, branch_type)</span><br><span class="line"></span><br><span class="line">        self.out_branches[ins_addr][stmt_idx].add_target(target_addr)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Merge another supernode into the current one.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        :param SuperCFGNode other: The supernode to merge with.</span></span><br><span class="line"><span class="string">        :return: None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> other.cfg_nodes:</span><br><span class="line">            self.insert_cfgnode(n)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ins_addr, outs <span class="keyword">in</span> other.out_branches.items():</span><br><span class="line">            <span class="keyword">if</span> ins_addr <span class="keyword">in</span> self.out_branches:</span><br><span class="line">                <span class="keyword">for</span> stmt_idx, item <span class="keyword">in</span> outs.items():</span><br><span class="line">                    <span class="keyword">if</span> stmt_idx <span class="keyword">in</span> self.out_branches[ins_addr]:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx].merge(item)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        self.out_branches[ins_addr][stmt_idx] = item</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = <span class="built_in">next</span>(<span class="built_in">iter</span>(outs.values()))</span><br><span class="line">                self.out_branches[ins_addr][item.stmt_idx] = item</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;SuperCFGNode %#08x, %d blocks, %d out branches&gt;&quot;</span> % (self.addr, <span class="built_in">len</span>(self.cfg_nodes),</span><br><span class="line">                                                                     <span class="built_in">len</span>(self.out_branches)</span><br><span class="line">                                                                     )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__hash__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hash</span>((<span class="string">&#x27;supercfgnode&#x27;</span>, self.addr))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(other, SuperCFGNode):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.addr == other.addr</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å»æ··æ·†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">st = <span class="number">0x0000000000400620</span> </span><br><span class="line">end = <span class="number">0x0000000000402144</span> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_instr</span>(<span class="params">addr</span>):</span><br><span class="line">    <span class="keyword">return</span> addr+idc.get_item_size(addr)		<span class="comment">#è·å–æŒ‡ä»¤æˆ–æ•°æ®é•¿åº¦ï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯å»å¾€ä¸‹ä¸€æ¡æŒ‡ä»¤</span></span><br><span class="line">    </span><br><span class="line">addr = st</span><br><span class="line"><span class="keyword">while</span>(addr&lt;end):</span><br><span class="line">    <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;ds:dword_603054&quot;</span> <span class="keyword">in</span> GetDisasm(addr):	<span class="comment">#GetDisasm(addr)å¾—åˆ°addrçš„åæ±‡ç¼–è¯­å¥</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">            addr = <span class="built_in">next</span></span><br><span class="line">            <span class="built_in">next</span> = next_instr(addr)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;jnz&quot;</span> <span class="keyword">in</span> GetDisasm(addr):</span><br><span class="line">                dest = idc.get_operand_value(addr, <span class="number">0</span>)		<span class="comment">#å¾—åˆ°æ“ä½œæ•°ï¼Œå°±æ˜¯æŒ‡ä»¤åçš„æ•°</span></span><br><span class="line">                ida_bytes.patch_byte(addr, <span class="number">0xe9</span>)     <span class="comment">#0xe9 jmpåé¢çš„å››ä¸ªå­—èŠ‚æ˜¯åç§»</span></span><br><span class="line">                ida_bytes.patch_byte(addr+<span class="number">5</span>, <span class="number">0x90</span>)   <span class="comment">#nopç¬¬äº”ä¸ªå­—èŠ‚</span></span><br><span class="line">                offset = dest - (addr + <span class="number">5</span>)  <span class="comment">#è°ƒæ•´ä¸ºæ­£ç¡®çš„åç§»åœ°å€ ä¹Ÿå°±æ˜¯ç›¸å¯¹åç§»åœ°å€ - å½“å‰æŒ‡ä»¤åçš„åœ°å€</span></span><br><span class="line">                ida_bytes.patch_dword(addr + <span class="number">1</span>, offset) <span class="comment">#æŠŠåœ°å€èµ‹å€¼ç»™jmpå</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;patch bcf: 0x%x&quot;</span>%addr)</span><br><span class="line">                addr = <span class="built_in">next</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        addr = <span class="built_in">next</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è§£å¯†è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">secret = [<span class="number">0xBC8FF26D43536296</span>, <span class="number">0x520100780530EE16</span>, <span class="number">0x4DC0B5EA935F08EC</span>,</span><br><span class="line">          <span class="number">0x342B90AFD853F450</span>, <span class="number">0x8B250EBCAA2C3681</span>, <span class="number">0x55759F81A2C68AE4</span>]</span><br><span class="line">key = <span class="number">0xB0004B7679FA26B3</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”ŸCRC32æŸ¥è¡¨æ³•æ‰€ç”¨çš„è¡¨</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> secret:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        sign = s &amp; <span class="number">1</span>                   <span class="comment">#åˆ¤æ–­é¦–ä½æ­£è´Ÿ</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s ^= key</span><br><span class="line">        s //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> sign == <span class="number">1</span>:</span><br><span class="line">            s |= <span class="number">0x8000000000000000</span>    <span class="comment"># é˜²æ­¢è´Ÿå€¼é™¤2ï¼Œæº¢å‡ºä¸ºæ­£å€¼</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(s))                      <span class="comment"># è¾“å‡ºè¡¨</span></span><br><span class="line">    <span class="comment"># è®¡ç®—CRC64</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(s&amp;<span class="number">0xFF</span>)</span><br><span class="line">        s &gt;&gt;= <span class="number">8</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Buuctf-RE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Buuctf-RE/" class="post-title-link" itemprop="url">Buuctf-Re</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:04:13" itemprop="dateCreated datePublished" datetime="2023-03-31T19:04:13+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 00:52:27" itemprop="dateModified" datetime="2023-04-01T00:52:27+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-jocker" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]jocker</h2><ol>
<li>exeæ–‡ä»¶ï¼Œ32ä½æ— å£³ï¼Œæ‹–å…¥IDA32</li>
<li>ctrl+f12å®šä½ä¸»ä½“å‡½æ•°ï¼Œä¿®æ”¹å˜é‡åæé«˜å¯è¯»æ€§</li>
<li>F5åæ±‡ç¼–å‘ç°æç¤ºæ ˆé”™è¯¯ï¼Œoptionè°ƒå‡ºæ ˆæŒ‡é’ˆï¼Œä¿®æ”¹æ ˆæŒ‡é’ˆä¸º0ï¼Œé‡æ–°F5</li>
<li>æŸ¥çœ‹è¾“å…¥ï¼Œ24ä½å­—ç¬¦ä¸²ï¼Œä¸»ä½“ï¼šå¤åˆ¶-&gt;åŠ å¯†-&gt;æ ¡å¯¹-&gt;encyptå‡½æ•°-&gt;finalå‡½æ•°</li>
<li>å‘ç°wrongå‡½æ•°åŠ å¯†ï¼Œomgå‡½æ•°æ ¡å¯¹ï¼Œç®€å•å¼‚æˆ–è§£å¯†ï¼Œæäº¤é”™è¯¯ï¼Œä¸ºéšœçœ¼æ³•ï¼ˆä½†æ˜¯å¾—åˆ°äº†æ­£ç¡®çš„è¾“å…¥å­—ç¬¦ä¸²ï¼‰</li>
<li>wrongå‡½æ•°ä¸Šæ–¹å¯¹è¾“å…¥çš„flagè¿›è¡Œäº†å¤åˆ¶ï¼ŒçœŸæ­£å¤„ç†çš„æ˜¯å¤åˆ¶åçš„flag</li>
<li>æ‰¾åˆ°ç›¸åº”çš„åŠ å¯†å‡½æ•°encyptï¼Œç»“æœæ˜¯åŠ¨æ€åŠ å¯†å‡½æ•°ï¼Œæ— æ³•ç›´æ¥F5</li>
<li>exeæ‹–å…¥ODï¼Œæ‰¾åˆ°è°ƒç”¨åŠ å¯†å‡½æ•°åœ°å€ï¼Œä¸‹æ–­ç‚¹ï¼Œè¾“å…¥æ­£ç¡®å­—ç¬¦ä¸²è¿è¡Œ</li>
<li>F7å•æ­¥è¿›å…¥åŠ å¯†å‡½æ•°ï¼ŒODdumpè„±å£³ï¼Œç”Ÿæˆæ–°æ–‡ä»¶</li>
<li>æ–°æ–‡ä»¶æ‹–å…¥IDAï¼ŒæŸ¥çœ‹encyptå‡½æ•°ï¼Œå¼‚æˆ–è§£å¯†å¾—åˆ°å‰19ä½flag</li>
<li>è¿˜å‰©æœ€å5ä½ï¼Œåªå‰©finalå‡½æ•°ï¼ŒæœªçŸ¥åŠ å¯†ï¼Œæç¤ºæ˜¯éšè—ï¼Œæ¨æ–­å’Œä¹‹å‰åŠ å¯†æ–¹å¼ç›¸åŒï¼Œä¸ºå¼‚æˆ–åŠ å¯†</li>
<li>åˆ©ç”¨æœ€åä¸€ä½â€}â€æ¨æ–­å‡ºå¼‚æˆ–keyï¼Œè¿›è¡Œè§£å¯†å¾—åˆ°æ­£ç¡®flag</li>
</ol>
<blockquote>
<p>æ ¸å¿ƒï¼šä¿®æ”¹ç”±äºåç»­åŠ¨æ€åŠ å¯†é€ æˆçš„æ ˆæŒ‡é’ˆé”™ä½ï¼Œè§£å¯†æ­£ç¡®è¾“å…¥ï¼ŒODåŠ¨æ€åŠ å¯†è„±å£³</p>
</blockquote>
<h2 id="SWPU2019-EasiestRe"><a href="#SWPU2019-EasiestRe" class="headerlink" title="[SWPU2019]EasiestRe"></a>[SWPU2019]EasiestRe</h2><ol>
<li>æ‹–å…¥exeinfopeï¼Œ32ä½æ— å£³ï¼Œè¿›IDA</li>
<li>ctrl+fæ‰¾åˆ°mainå‡½æ•°å‘ç°GetThreadContextã€SetThreadContextç­‰ç­‰å‡½æ•°ï¼Œå¤šçº¿ç¨‹æ²¡è·‘äº†ï¼Œå…ˆæ”¾ä¸€è¾¹</li>
<li>ctrl+f12å­—ç¬¦ä¸²æŸ¥æ‰¾flagæ‰¾åˆ°ä¸»ä½“å‡½æ•°(äº¤å‰å¼•ç”¨)ï¼Œä¿®æ”¹å˜é‡åæé«˜å¯è¯»æ€§</li>
<li>F5åç¼–å‘ç°__debugbreak()ï¼Œint3æ–­ç‚¹ï¼Œå¯ä»¥å‡†å¤‡æ”¹äºŒè¿›åˆ¶äº†ï¼Œç»§ç»­æŸ¥çœ‹è¿˜ä¸æ­¢ä¸€ä¸ª</li>
<li>é‡æ–°çœ‹çº¿ç¨‹ï¼Œæ˜¯ä¸ªçˆ¶å­çº¿ç¨‹ä¿æŠ¤ï¼Œå­çº¿ç¨‹åŠ å¯†ï¼ŒæŸ¥çœ‹å‡½æ•°æ•è·é‡è¦é•¿æ•°ç»„v16ã€v15</li>
<li>æ‰€ä»¥åˆæ˜¯åŠ¨æ€åŠ å¯†ï¼Œè¿”å›__debugbreak()å¤„tabçœ‹æ±‡ç¼–ï¼Œint3+nopçš„é•¿åº¦å’Œv16å¯¹çš„ä¸Šï¼Œé‚£å°±æŠŠv16æ¬è¿‡å»ï¼Œæ”¹äºŒè¿›åˆ¶ï¼Œé‡æ–°åç¼–</li>
<li>è§‚å¯Ÿä¸»ä½“å‡½æ•°ï¼šè¾“å…¥-&gt;åŠ å¯†-&gt;check-&gt;è¾“å‡º</li>
<li>è¿›å…¥åŠ å¯†ï¼Œåˆæœ‰__debugbreak()ï¼Œå’Œä¸Šé¢ä¸€æ ·çš„æ–¹å¼ï¼Œç”¨v15æ”¹äºŒè¿›åˆ¶ç ï¼Œåç¼–</li>
<li>è¿›å…¥checkå‡½æ•°ï¼ŒtabæŸ¥çœ‹æ±‡ç¼–ï¼Œ408638åœ°å€å¤„å‘ç°â€œcmp [ebp+var_20], 18hâ€æ ¡å¯¹æŒ‡ä»¤</li>
<li>æŸ¥çœ‹å¯¹åº”åœ°å€ï¼Œæ‰¾åˆ°æ ¡å¯¹å­—ç¬¦ä¸²ï¼ˆå³åŠ å¯†ç»“æœï¼‰</li>
<li>è¿”å›åŠ å¯†å‡½æ•°ï¼Œåˆ†æï¼Œä¸‰æ¬¡åŠ å¯†(å¼‚æˆ–â€“&gt;åˆ†æ®µâ€“&gt;ç§»ä½)</li>
<li>é€†å†™è§£å¯†</li>
</ol>
<p>æ ¸å¿ƒï¼šåŒçº¿ç¨‹ä¿æŠ¤ç³»ç»Ÿï¼Œint3æ–­ç‚¹(0xcc)ï¼ŒäºŒè¿›åˆ¶ä¿®æ”¹</p>
<h2 id="WMCTF2020-easy-re"><a href="#WMCTF2020-easy-re" class="headerlink" title="[WMCTF2020]easy_re"></a>[WMCTF2020]easy_re</h2><ul>
<li>perlå¤„ç†ï¼šä¸€ç§è§£é‡Šè¯­è¨€ï¼Œè¿è¡Œæ—¶è§£å‹ï¼ŒåŠ¨è°ƒå¤„ç†<ul>
<li>æœç´¢scriptå…³é”®è¯ï¼Œæ‰¾åˆ°perlè„šæœ¬è°ƒç”¨å¤„</li>
<li>å†å…³é”®ç‚¹ä¸‹é¢è®¾æ–­ç‚¹ï¼ŒF8è¿è¡Œåˆ°è„šæœ¬æ‰§è¡Œå®Œæ¯•</li>
<li>ä¸‹ä¸€ä¸ªeaxä¸­å¯è§åŸæ–‡</li>
</ul>
</li>
</ul>
<h2 id="BJDCTF2020-hamburger-competition"><a href="#BJDCTF2020-hamburger-competition" class="headerlink" title="[BJDCTF2020]hamburger competition"></a>[BJDCTF2020]hamburger competition</h2><ul>
<li><p>ä¸€ä¸ªunityæ¸¸æˆé€†å‘é—®é¢˜</p>
</li>
<li><p>å·¥å…·ï¼šdnspy</p>
</li>
<li><p>æ ¸å¿ƒä»£ç ä¸€èˆ¬è·¯å¾„ï¼š</p>
<blockquote>
<p>\TPH\TPH_Data\Managed\Assembly-CSharp.dll</p>
</blockquote>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Note2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Note2/" class="post-title-link" itemprop="url">Core Principles of Reverse Engineering --Note2</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:03:18" itemprop="dateCreated datePublished" datetime="2023-03-31T19:03:18+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:09:45" itemprop="dateModified" datetime="2023-04-01T10:09:45+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="PEæ–‡ä»¶æ ¼å¼"><a href="#PEæ–‡ä»¶æ ¼å¼" class="headerlink" title="PEæ–‡ä»¶æ ¼å¼"></a>PEæ–‡ä»¶æ ¼å¼</h1><h2 id="ç§ç±»"><a href="#ç§ç±»" class="headerlink" title="ç§ç±»"></a>ç§ç±»</h2><table>
<thead>
<tr>
<th>ç§ç±»</th>
<th>ä¸»æ‰©å±•å</th>
</tr>
</thead>
<tbody><tr>
<td>å¯æ‰§è¡Œç³»åˆ—</td>
<td>EXEï¼ŒSCR</td>
</tr>
<tr>
<td>åº“ç³»åˆ—</td>
<td>DLLï¼ŒOCXï¼ŒCPLï¼ŒDRV</td>
</tr>
<tr>
<td>é©±åŠ¨ç¨‹åºç³»åˆ—</td>
<td>SYSï¼ŒVXD</td>
</tr>
<tr>
<td>å¯¹è±¡æ–‡ä»¶ç³»åˆ—</td>
<td>OBJ</td>
</tr>
</tbody></table>
<h2 id="é›¶ç¢ç‚¹"><a href="#é›¶ç¢ç‚¹" class="headerlink" title="é›¶ç¢ç‚¹"></a>é›¶ç¢ç‚¹</h2><ol>
<li>PEæ–‡ä»¶åˆ†PEå¤´ä¸PEä½“</li>
<li>PEå¤´ç”±å„ç§ç»“æ„ä½“æ„æˆï¼Œè¯´æ˜äº†æ–‡ä»¶å¤§å°ã€æ‰§è¡Œåœ°å€ç­‰ç­‰ä¿¡æ¯ï¼ŒPEä½“åˆ†å¤šä¸ªèŠ‚åŒºï¼Œå¦‚ä»£ç æ®µã€æ•°æ®æ®µã€èµ„æºæ®µç­‰ã€‚</li>
<li>PEæ–‡ä»¶åœ¨å†…å­˜ä¸­å’Œåœ¨ç£ç›˜ä¸­å¤§å°ä¸åŒ</li>
<li>RVA(ç›¸å¯¹è™šæ‹Ÿåœ°å€) VA(è™šæ‹Ÿå†…å­˜ç»å¯¹åœ°å€) RAW(æ–‡ä»¶åç§»)</li>
</ol>
<h2 id="PEå¤´åˆ†è§£"><a href="#PEå¤´åˆ†è§£" class="headerlink" title="PEå¤´åˆ†è§£"></a>PEå¤´åˆ†è§£</h2><h3 id="DOSå¤´"><a href="#DOSå¤´" class="headerlink" title="DOSå¤´"></a>DOSå¤´</h3><p>æ ¸å¿ƒå‚æ•°ï¼š</p>
<ul>
<li>e_magic:DOSç­¾åï¼Œâ€œMZâ€ï¼ˆDOSå¯æ‰§è¡Œæ–‡ä»¶è®¾è®¡è€…ï¼‰</li>
<li>e_lfanew:æŒ‡ç¤ºNTå¤´çš„åç§»</li>
</ul>
<h3 id="DOSå­˜æ ¹"><a href="#DOSå­˜æ ¹" class="headerlink" title="DOSå­˜æ ¹"></a>DOSå­˜æ ¹</h3><p>ä¸€ä¸ªå¯å¿½ç•¥é¡¹ï¼Œå¯ç†è§£ä¸ºDOSä¸‹æ‰§è¡Œçš„æ•°æ®</p>
<blockquote>
<p>ä¾‹å¦‚notepad.exeä¸­çš„æç¤ºè¯­:This program cannot be run in DOS mode</p>
</blockquote>
<h3 id="NTå¤´"><a href="#NTå¤´" class="headerlink" title="NTå¤´"></a>NTå¤´</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_NT_HEADERS &#123;</span><br><span class="line">    DWORD Signature;                             //ç­¾åâ€œPEâ€</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;                //æ–‡ä»¶å¤´</span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;      //å¯é€‰å¤´</span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure>

<h4 id="æ–‡ä»¶å¤´"><a href="#æ–‡ä»¶å¤´" class="headerlink" title="æ–‡ä»¶å¤´"></a>æ–‡ä»¶å¤´</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_FILE_HEADER &#123;</span><br><span class="line">    WORD    Machine;                  //æœºå™¨ç ï¼ˆæ¯ç§CPUéƒ½æœ‰å„è‡ªçš„å›ºå®šå€¼ï¼Œå¦‚intel x86çš„14Cï¼‰</span><br><span class="line">    WORD    NumberOfSections;         //èŠ‚åŒºæ•°é‡</span><br><span class="line">    DWORD   TimeDateStamp;</span><br><span class="line">    DWORD   PointerToSymbolTable;</span><br><span class="line">    DWORD   NumberOfSymbols;</span><br><span class="line">    WORD    SizeOfOptionalHeader;     //æŒ‡ç¤ºå¯é€‰å¤´çš„å¤§å°</span><br><span class="line">    WORD    Characteristics;          //æ ‡è¯†æ–‡ä»¶å±æ€§ï¼ˆæ˜¯å¦ä¸ºDLLç­‰ç­‰ï¼‰</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER</span><br></pre></td></tr></table></figure>

<h4 id="å¯é€‰å¤´-ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†"><a href="#å¯é€‰å¤´-ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†" class="headerlink" title="å¯é€‰å¤´(ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†)"></a>å¯é€‰å¤´(ç›´æ¥æŠŠ64ä½çš„æ¬è¿‡æ¥äº†)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _IMAGE_OPTIONAL_HEADER64 &#123;</span><br><span class="line">    WORD        Magic;                       //32-10Bï¼Œ 64-20B</span><br><span class="line">    BYTE        MajorLinkerVersion;          </span><br><span class="line">    BYTE        MinorLinkerVersion;</span><br><span class="line">    DWORD       SizeOfCode;</span><br><span class="line">    DWORD       SizeOfInitializedData;</span><br><span class="line">    DWORD       SizeOfUninitializedData;</span><br><span class="line">    DWORD       AddressOfEntryPoint;         //PEçš„RVAå€¼ï¼ŒæŒ‡å‡ºä»£ç èµ·å§‹ä½ç½®</span><br><span class="line">    DWORD       BaseOfCode;</span><br><span class="line">    ULONGLONG   ImageBase;                   //åŸºå‡†ï¼ŒVA = RVA + ImageBase</span><br><span class="line">    DWORD       SectionAlignment;            //èŠ‚åŒºå†…å­˜æœ€å°å•ä½</span><br><span class="line">    DWORD       FileAlignment;               //èŠ‚åŒºç£ç›˜æœ€å°å•ä½</span><br><span class="line">    WORD        MajorOperatingSystemVersion;</span><br><span class="line">    WORD        MinorOperatingSystemVersion;</span><br><span class="line">    WORD        MajorImageVersion;</span><br><span class="line">    WORD        MinorImageVersion;</span><br><span class="line">    WORD        MajorSubsystemVersion;</span><br><span class="line">    WORD        MinorSubsystemVersion;</span><br><span class="line">    DWORD       Win32VersionValue;</span><br><span class="line">    DWORD       SizeOfImage;                 //æŒ‡å®šåœ¨è™šæ‹Ÿå†…å­˜ä¸­æ‰€å ç©ºé—´å¤§å°</span><br><span class="line">    DWORD       SizeOfHeaders;               //PEå¤´å¤§å°ï¼ˆç¬¬ä¸€èŠ‚åŒºæ‰€åœ¨ä½ç½®ä¸è¯¥å€¼è·æ–‡ä»¶å¼€å§‹åç§»é‡ç›¸åŒï¼‰</span><br><span class="line">    DWORD       CheckSum;</span><br><span class="line">    WORD        Subsystem;                   //åŒºåˆ†æ–‡ä»¶</span><br><span class="line">                                              1 Driveræ–‡ä»¶ï¼ˆç³»ç»Ÿé©±åŠ¨ï¼‰</span><br><span class="line">                                              2 GUIæ–‡ä»¶ï¼ˆçª—å£åº”ç”¨ç¨‹åºï¼‰</span><br><span class="line">                                              3 CUIæ–‡ä»¶ï¼ˆæ§åˆ¶å°åº”ç”¨ç¨‹åºï¼‰</span><br><span class="line">    WORD        DllCharacteristics;</span><br><span class="line">    ULONGLONG   SizeOfStackReserve;</span><br><span class="line">    ULONGLONG   SizeOfStackCommit;</span><br><span class="line">    ULONGLONG   SizeOfHeapReserve;</span><br><span class="line">    ULONGLONG   SizeOfHeapCommit;</span><br><span class="line">    DWORD       LoaderFlags;</span><br><span class="line">    DWORD       NumberOfRvaAndSizes;         //</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;</span><br></pre></td></tr></table></figure>

<h3 id="èŠ‚åŒºå¤´"><a href="#èŠ‚åŒºå¤´" class="headerlink" title="èŠ‚åŒºå¤´"></a>èŠ‚åŒºå¤´</h3><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><table>
<thead>
<tr>
<th>ç±»åˆ«</th>
<th>è®¿é—®æƒé™</th>
</tr>
</thead>
<tbody><tr>
<td>code</td>
<td>æ‰§è¡Œï¼Œè¯»å–æƒé™</td>
</tr>
<tr>
<td>data</td>
<td>éæ‰§è¡Œï¼Œè¯»å†™æƒé™</td>
</tr>
<tr>
<td>resource</td>
<td>éæ‰§è¡Œï¼Œè¯»å–æƒé™</td>
</tr>
</tbody></table>
<h4 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_SIZEOF_SHORT_NAME              8</span><br><span class="line"></span><br><span class="line">typedef struct _IMAGE_SECTION_HEADER &#123;</span><br><span class="line">    BYTE    Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    union &#123;</span><br><span class="line">            DWORD   PhysicalAddress;</span><br><span class="line">            DWORD   VirtualSize;            //å†…å­˜ä¸­èŠ‚åŒºå¤§å°</span><br><span class="line">    &#125; Misc;</span><br><span class="line">    DWORD   VirtualAddress;                 //å†…å­˜ä¸­èŠ‚åŒºèµ·å§‹åœ°å€ï¼ˆRVAï¼‰</span><br><span class="line">    DWORD   SizeOfRawData;                  //ç£ç›˜ä¸­èŠ‚åŒºå¤§å°</span><br><span class="line">    DWORD   PointerToRawData;               //ç£ç›˜ä¸­èŠ‚åŒºèµ·å§‹åœ°å€</span><br><span class="line">    DWORD   PointerToRelocations;</span><br><span class="line">    DWORD   PointerToLinenumbers;</span><br><span class="line">    WORD    NumberOfRelocations;</span><br><span class="line">    WORD    NumberOfLinenumbers;</span><br><span class="line">    DWORD   Characteristics;                //èŠ‚åŒºå±æ€§</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure>

<h2 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h2><ul>
<li>RAW &#x3D; RVA - (VA)VirtualAddress + PointerToRawData</li>
</ul>
<h1 id="DLLæ–‡ä»¶"><a href="#DLLæ–‡ä»¶" class="headerlink" title="DLLæ–‡ä»¶"></a>DLLæ–‡ä»¶</h1><ul>
<li>ï¼ˆDynamic Link Libraryï¼‰åŠ¨æ€é“¾æ¥åº“</li>
<li>ç›®çš„ï¼šè§£å†³åœ¨å¤šè¿›ç¨‹æ—¶ä¸€ä¸ªç³»ç»ŸAPIå¯èƒ½ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œå¤šæ¬¡åŠ è½½åˆ°å†…å­˜é€ æˆç©ºé—´æµªè´¹çš„é—®é¢˜</li>
<li>æè¿°ï¼š<ul>
<li>åº“å°è£…ï¼Œå•ç‹¬ç»„æˆDLLæ–‡ä»¶</li>
<li>å†…å­˜æ˜ å°„æŠ€æœ¯ï¼Œå®ç°å¤šè¿›ç¨‹å…±äº«åŒä¸€ä¸ªæ–‡ä»¶</li>
<li>æ›´æ–°åº“æ—¶æ›¿æ¢å¯¹åº”DLLæ–‡ä»¶</li>
</ul>
</li>
<li>åŠ è½½æ–¹å¼ï¼š<ul>
<li>æ˜¾å¼é“¾æ¥ï¼šä½¿ç”¨æ—¶åŠ è½½ï¼Œç”¨å®Œåé‡Šæ”¾å†…å­˜</li>
<li>éšå¼é“¾æ¥ï¼šåŠ è½½ç¨‹åºæ—¶å°†DLLå…¨éƒ¨åŠ è½½ï¼Œç¨‹åºç»ˆæ­¢åé‡Šæ”¾å†…å­˜</li>
</ul>
</li>
</ul>
<h1 id="èŠ‚åŒºåˆ é™¤"><a href="#èŠ‚åŒºåˆ é™¤" class="headerlink" title="èŠ‚åŒºåˆ é™¤"></a>èŠ‚åŒºåˆ é™¤</h1><ol>
<li>åˆ é™¤èŠ‚åŒºå¤´ï¼ŒPEviewä¸­æŸ¥çœ‹èŠ‚åŒºå¤´èµ·å§‹åœ°å€åŠé•¿åº¦ï¼Œåœ¨hexç¼–è¾‘å™¨ä¸­å°†è¯¥åŒºåŸŸç”¨0è¦†ç›–</li>
<li>åˆ é™¤èŠ‚åŒºï¼ŒæŸ¥çœ‹èŠ‚åŒºèµ·å§‹åç§»åŠé•¿åº¦ï¼Œhexç¼–è¾‘å™¨ä¸­åˆ é™¤</li>
<li>ä¿®æ”¹IMAGE_FILE_HEADER[Number Of Sections -&#x3D; 1]</li>
<li>ä¿®æ”¹IMAGE_OPTIONAL_HEADER[Size Of Imageå‡å°‘å¯¹åº”é•¿åº¦]</li>
</ol>
<h1 id="é™„è¡¨ï¼š"><a href="#é™„è¡¨ï¼š" class="headerlink" title="é™„è¡¨ï¼š"></a>é™„è¡¨ï¼š</h1><h2 id="DataDirectoryç»“æ„ä½“æ•°ç»„-64-01239ä¸ºé‡ç‚¹"><a href="#DataDirectoryç»“æ„ä½“æ•°ç»„-64-01239ä¸ºé‡ç‚¹" class="headerlink" title="DataDirectoryç»“æ„ä½“æ•°ç»„(64)[01239ä¸ºé‡ç‚¹]"></a>DataDirectoryç»“æ„ä½“æ•°ç»„(64)[01239ä¸ºé‡ç‚¹]</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_DIRECTORY_ENTRY_EXPORT          0   // Export Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_IMPORT          1   // Import Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_RESOURCE        2   // Resource Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   // Exception Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_SECURITY        4   // Security Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_BASERELOC       5   // Base Relocation Table</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_DEBUG           6   // Debug Directory</span><br><span class="line">        IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   // (X86 usage)</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   // Architecture Specific Data</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   // RVA of GP</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_TLS             9   // TLS Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   // Load Configuration Directory</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   // Bound Import Directory in headers</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_IAT            12   // Import Address Table</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   // Delay Load Import Descriptors</span><br><span class="line">#define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   // COM Runtime descriptor</span><br></pre></td></tr></table></figure>

<h2 id="Machineå€¼"><a href="#Machineå€¼" class="headerlink" title="Machineå€¼"></a>Machineå€¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_FILE_MACHINE_UNKNOWN           0</span><br><span class="line">#define IMAGE_FILE_MACHINE_I386              0x014c  // Intel 386.</span><br><span class="line">#define IMAGE_FILE_MACHINE_R3000             0x0162  // MIPS little-endian, 0x160 big-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R4000             0x0166  // MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_R10000            0x0168  // MIPS little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_WCEMIPSV2         0x0169  // MIPS little-endian WCE v2</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA             0x0184  // Alpha_AXP</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3               0x01a2  // SH3 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3DSP            0x01a3</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH3E              0x01a4  // SH3E little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH4               0x01a6  // SH4 little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_SH5               0x01a8  // SH5</span><br><span class="line">#define IMAGE_FILE_MACHINE_ARM               0x01c0  // ARM Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_THUMB             0x01c2</span><br><span class="line">#define IMAGE_FILE_MACHINE_AM33              0x01d3</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPC           0x01F0  // IBM PowerPC Little-Endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_POWERPCFP         0x01f1</span><br><span class="line">#define IMAGE_FILE_MACHINE_IA64              0x0200  // Intel 64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPS16            0x0266  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_ALPHA64           0x0284  // ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU           0x0366  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_MIPSFPU16         0x0466  // MIPS</span><br><span class="line">#define IMAGE_FILE_MACHINE_AXP64             IMAGE_FILE_MACHINE_ALPHA64</span><br><span class="line">#define IMAGE_FILE_MACHINE_TRICORE           0x0520  // Infineon</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEF               0x0CEF</span><br><span class="line">#define IMAGE_FILE_MACHINE_EBC               0x0EBC  // EFI Byte Code</span><br><span class="line">#define IMAGE_FILE_MACHINE_AMD64             0x8664  // AMD64 (K8)</span><br><span class="line">#define IMAGE_FILE_MACHINE_M32R              0x9041  // M32R little-endian</span><br><span class="line">#define IMAGE_FILE_MACHINE_CEE               0xC0EE</span><br></pre></td></tr></table></figure>

<h2 id="Characteristicså€¼"><a href="#Characteristicså€¼" class="headerlink" title="Characteristicså€¼"></a>Characteristicså€¼</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#define IMAGE_FILE_RELOCS_STRIPPED           0x0001  // Relocation info stripped from file.</span><br><span class="line">#define IMAGE_FILE_EXECUTABLE_IMAGE          0x0002  // File is executable  (i.e. no unresolved externel references).</span><br><span class="line">#define IMAGE_FILE_LINE_NUMS_STRIPPED        0x0004  // Line nunbers stripped from file.</span><br><span class="line">#define IMAGE_FILE_LOCAL_SYMS_STRIPPED       0x0008  // Local symbols stripped from file.</span><br><span class="line">#define IMAGE_FILE_AGGRESIVE_WS_TRIM         0x0010  // Agressively trim working set</span><br><span class="line">#define IMAGE_FILE_LARGE_ADDRESS_AWARE       0x0020  // App can handle &gt;2gb addresses</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_LO         0x0080  // Bytes of machine word are reversed.</span><br><span class="line">#define IMAGE_FILE_32BIT_MACHINE             0x0100  // 32 bit word machine.</span><br><span class="line">#define IMAGE_FILE_DEBUG_STRIPPED            0x0200  // Debugging info stripped from file in .DBG file</span><br><span class="line">#define IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP   0x0400  // If Image is on removable media, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_NET_RUN_FROM_SWAP         0x0800  // If Image is on Net, copy and run from the swap file.</span><br><span class="line">#define IMAGE_FILE_SYSTEM                    0x1000  // System File.</span><br><span class="line">#define IMAGE_FILE_DLL                       0x2000  // File is a DLL.</span><br><span class="line">#define IMAGE_FILE_UP_SYSTEM_ONLY            0x4000  // File should only be run on a UP machine</span><br><span class="line">#define IMAGE_FILE_BYTES_REVERSED_HI         0x8000  // Bytes of machine word are reversed.</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Note1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Note1/" class="post-title-link" itemprop="url">Core Principles of Reverse Engineering --Note1</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:03:01" itemprop="dateCreated datePublished" datetime="2023-03-31T19:03:01+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 10:08:49" itemprop="dateModified" datetime="2023-04-01T10:08:49+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Reverse/" itemprop="url" rel="index"><span itemprop="name">Reverse</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>cç¼–è¯‘è¿‡ç¨‹</li>
<li>å¸¸è§å¯„å­˜å™¨</li>
<li>æ ˆå¸§</li>
<li>å‡½æ•°è°ƒç”¨çº¦å®š</li>
</ul>
<hr>
<p>## cç¼–è¯‘è¿‡ç¨‹</p>
<p>é¢„å¤„ç†â€“&gt;ç¼–è¯‘â€“&gt;æ±‡ç¼–â€“&gt;é“¾æ¥\</p>
<h4 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;hello&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="é¢„å¤„ç†"><a href="#é¢„å¤„ç†" class="headerlink" title="é¢„å¤„ç†"></a>é¢„å¤„ç†</h4><ul>
<li>æ‰©å±•æºæ–‡ä»¶ä¸­æ‰€æœ‰ç”¨åˆ°çš„å®å’Œå¤´æ–‡ä»¶</li>
<li>gcc -E -P main.c</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line">typedef long unsigned int size_t;</span><br><span class="line">typedef __builtin_va_list __gnuc_va_list;</span><br><span class="line">typedef unsigned char __u_char;</span><br><span class="line">typedef unsigned short int __u_short;</span><br><span class="line">typedef unsigned int __u_int;</span><br><span class="line">typedef unsigned long int __u_long;</span><br><span class="line">typedef signed char __int8_t;</span><br><span class="line">typedef unsigned char __uint8_t;</span><br><span class="line">typedef signed short int __int16_t;</span><br><span class="line">typedef unsigned short int __uint16_t;</span><br><span class="line">typedef signed int __int32_t;</span><br><span class="line">typedef unsigned int __uint32_t;</span><br><span class="line">typedef signed long int __int64_t;</span><br><span class="line">typedef unsigned long int __uint64_t;</span><br><span class="line">typedef __int8_t __int_least8_t;</span><br><span class="line">typedef __uint8_t __uint_least8_t;</span><br><span class="line">typedef __int16_t __int_least16_t;</span><br><span class="line">typedef __uint16_t __uint_least16_t;</span><br><span class="line">typedef __int32_t __int_least32_t;</span><br><span class="line">typedef __uint32_t __uint_least32_t;</span><br><span class="line">typedef __int64_t __int_least64_t;</span><br><span class="line">typedef __uint64_t __uint_least64_t;</span><br><span class="line">typedef long int __quad_t;</span><br><span class="line">typedef unsigned long int __u_quad_t;</span><br><span class="line">typedef long int __intmax_t;</span><br><span class="line">typedef unsigned long int __uintmax_t;</span><br><span class="line">typedef unsigned long int __dev_t;</span><br><span class="line">typedef unsigned int __uid_t;</span><br><span class="line">typedef unsigned int __gid_t;</span><br><span class="line">typedef unsigned long int __ino_t;</span><br><span class="line">typedef unsigned long int __ino64_t;</span><br><span class="line">typedef unsigned int __mode_t;</span><br><span class="line">typedef unsigned long int __nlink_t;</span><br><span class="line">typedef long int __off_t;</span><br><span class="line">typedef long int __off64_t;</span><br><span class="line">typedef int __pid_t;</span><br><span class="line">typedef struct &#123; int __val[2]; &#125; __fsid_t;</span><br><span class="line">typedef long int __clock_t;</span><br><span class="line">typedef unsigned long int __rlim_t;</span><br><span class="line">typedef unsigned long int __rlim64_t;</span><br><span class="line">typedef unsigned int __id_t;</span><br><span class="line">typedef long int __time_t;</span><br><span class="line">typedef unsigned int __useconds_t;</span><br><span class="line">typedef long int __suseconds_t;</span><br><span class="line">typedef long int __suseconds64_t;</span><br><span class="line">typedef int __daddr_t;</span><br><span class="line">typedef int __key_t;</span><br><span class="line">typedef int __clockid_t;</span><br><span class="line">typedef void * __timer_t;</span><br><span class="line">typedef long int __blksize_t;</span><br><span class="line">typedef long int __blkcnt_t;</span><br><span class="line">typedef long int __blkcnt64_t;</span><br><span class="line">typedef unsigned long int __fsblkcnt_t;</span><br><span class="line">typedef unsigned long int __fsblkcnt64_t;</span><br><span class="line">typedef unsigned long int __fsfilcnt_t;</span><br><span class="line">typedef unsigned long int __fsfilcnt64_t;</span><br><span class="line">typedef long int __fsword_t;</span><br><span class="line">typedef long int __ssize_t;</span><br><span class="line">typedef long int __syscall_slong_t;</span><br><span class="line">typedef unsigned long int __syscall_ulong_t;</span><br><span class="line">typedef __off64_t __loff_t;</span><br><span class="line">typedef char *__caddr_t;</span><br><span class="line">typedef long int __intptr_t;</span><br><span class="line">typedef unsigned int __socklen_t;</span><br><span class="line">typedef int __sig_atomic_t;</span><br><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">  int __count;</span><br><span class="line">  union</span><br><span class="line">  &#123;</span><br><span class="line">    unsigned int __wch;</span><br><span class="line">    char __wchb[4];</span><br><span class="line">  &#125; __value;</span><br><span class="line">&#125; __mbstate_t;</span><br><span class="line">typedef struct _G_fpos_t</span><br><span class="line">&#123;</span><br><span class="line">  __off_t __pos;</span><br><span class="line">  __mbstate_t __state;</span><br><span class="line">&#125; __fpos_t;</span><br><span class="line">typedef struct _G_fpos64_t</span><br><span class="line">&#123;</span><br><span class="line">  __off64_t __pos;</span><br><span class="line">  __mbstate_t __state;</span><br><span class="line">&#125; __fpos64_t;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">typedef struct _IO_FILE __FILE;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">typedef struct _IO_FILE FILE;</span><br><span class="line">struct _IO_FILE;</span><br><span class="line">struct _IO_marker;</span><br><span class="line">struct _IO_codecvt;</span><br><span class="line">struct _IO_wide_data;</span><br><span class="line">typedef void _IO_lock_t;</span><br><span class="line">struct _IO_FILE</span><br><span class="line">&#123;</span><br><span class="line">  int _flags;</span><br><span class="line">  char *_IO_read_ptr;</span><br><span class="line">  char *_IO_read_end;</span><br><span class="line">  char *_IO_read_base;</span><br><span class="line">  char *_IO_write_base;</span><br><span class="line">  char *_IO_write_ptr;</span><br><span class="line">  char *_IO_write_end;</span><br><span class="line">  char *_IO_buf_base;</span><br><span class="line">  char *_IO_buf_end;</span><br><span class="line">  char *_IO_save_base;</span><br><span class="line">  char *_IO_backup_base;</span><br><span class="line">  char *_IO_save_end;</span><br><span class="line">  struct _IO_marker *_markers;</span><br><span class="line">  struct _IO_FILE *_chain;</span><br><span class="line">  int _fileno;</span><br><span class="line">  int _flags2;</span><br><span class="line">  __off_t _old_offset;</span><br><span class="line">  unsigned short _cur_column;</span><br><span class="line">  signed char _vtable_offset;</span><br><span class="line">  char _shortbuf[1];</span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line">  __off64_t _offset;</span><br><span class="line">  struct _IO_codecvt *_codecvt;</span><br><span class="line">  struct _IO_wide_data *_wide_data;</span><br><span class="line">  struct _IO_FILE *_freeres_list;</span><br><span class="line">  void *_freeres_buf;</span><br><span class="line">  size_t __pad5;</span><br><span class="line">  int _mode;</span><br><span class="line">  char _unused2[15 * sizeof (int) - 4 * sizeof (void *) - sizeof (size_t)];</span><br><span class="line">&#125;;</span><br><span class="line">typedef __gnuc_va_list va_list;</span><br><span class="line">typedef __off_t off_t;</span><br><span class="line">typedef __ssize_t ssize_t;</span><br><span class="line">typedef __fpos_t fpos_t;</span><br><span class="line">extern FILE *stdin;</span><br><span class="line">extern FILE *stdout;</span><br><span class="line">extern FILE *stderr;</span><br><span class="line">extern int remove (const char *__filename) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int rename (const char *__old, const char *__new) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int renameat (int __oldfd, const char *__old, int __newfd,</span><br><span class="line">       const char *__new) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fclose (FILE *__stream);</span><br><span class="line">extern FILE *tmpfile (void)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern char *tmpnam (char[20]) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern char *tmpnam_r (char __s[20]) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern char *tempnam (const char *__dir, const char *__pfx)</span><br><span class="line">   __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (__builtin_free, 1)));</span><br><span class="line">extern int fflush (FILE *__stream);</span><br><span class="line">extern int fflush_unlocked (FILE *__stream);</span><br><span class="line">extern FILE *fopen (const char *__restrict __filename,</span><br><span class="line">      const char *__restrict __modes)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *freopen (const char *__restrict __filename,</span><br><span class="line">        const char *__restrict __modes,</span><br><span class="line">        FILE *__restrict __stream) ;</span><br><span class="line">extern FILE *fdopen (int __fd, const char *__modes) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *fmemopen (void *__s, size_t __len, const char *__modes)</span><br><span class="line">  __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern FILE *open_memstream (char **__bufloc, size_t *__sizeloc) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (fclose, 1))) ;</span><br><span class="line">extern void setbuf (FILE *__restrict __stream, char *__restrict __buf) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int setvbuf (FILE *__restrict __stream, char *__restrict __buf,</span><br><span class="line">      int __modes, size_t __n) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern void setbuffer (FILE *__restrict __stream, char *__restrict __buf,</span><br><span class="line">         size_t __size) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern void setlinebuf (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fprintf (FILE *__restrict __stream,</span><br><span class="line">      const char *__restrict __format, ...);</span><br><span class="line">extern int printf (const char *__restrict __format, ...);</span><br><span class="line">extern int sprintf (char *__restrict __s,</span><br><span class="line">      const char *__restrict __format, ...) __attribute__ ((__nothrow__));</span><br><span class="line">extern int vfprintf (FILE *__restrict __s, const char *__restrict __format,</span><br><span class="line">       __gnuc_va_list __arg);</span><br><span class="line">extern int vprintf (const char *__restrict __format, __gnuc_va_list __arg);</span><br><span class="line">extern int vsprintf (char *__restrict __s, const char *__restrict __format,</span><br><span class="line">       __gnuc_va_list __arg) __attribute__ ((__nothrow__));</span><br><span class="line">extern int snprintf (char *__restrict __s, size_t __maxlen,</span><br><span class="line">       const char *__restrict __format, ...)</span><br><span class="line">     __attribute__ ((__nothrow__)) __attribute__ ((__format__ (__printf__, 3, 4)));</span><br><span class="line">extern int vsnprintf (char *__restrict __s, size_t __maxlen,</span><br><span class="line">        const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__nothrow__)) __attribute__ ((__format__ (__printf__, 3, 0)));</span><br><span class="line">extern int vdprintf (int __fd, const char *__restrict __fmt,</span><br><span class="line">       __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__printf__, 2, 0)));</span><br><span class="line">extern int dprintf (int __fd, const char *__restrict __fmt, ...)</span><br><span class="line">     __attribute__ ((__format__ (__printf__, 2, 3)));</span><br><span class="line">extern int fscanf (FILE *__restrict __stream,</span><br><span class="line">     const char *__restrict __format, ...) ;</span><br><span class="line">extern int scanf (const char *__restrict __format, ...) ;</span><br><span class="line">extern int sscanf (const char *__restrict __s,</span><br><span class="line">     const char *__restrict __format, ...) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int fscanf (FILE *__restrict __stream, const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_fscanf&quot;) ;</span><br><span class="line">extern int scanf (const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_scanf&quot;) ;</span><br><span class="line">extern int sscanf (const char *__restrict __s, const char *__restrict __format, ...) __asm__ (&quot;&quot; &quot;__isoc99_sscanf&quot;) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int vfscanf (FILE *__restrict __s, const char *__restrict __format,</span><br><span class="line">      __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0))) ;</span><br><span class="line">extern int vscanf (const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 1, 0))) ;</span><br><span class="line">extern int vsscanf (const char *__restrict __s,</span><br><span class="line">      const char *__restrict __format, __gnuc_va_list __arg)</span><br><span class="line">     __attribute__ ((__nothrow__ , __leaf__)) __attribute__ ((__format__ (__scanf__, 2, 0)));</span><br><span class="line">extern int vfscanf (FILE *__restrict __s, const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vfscanf&quot;)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0))) ;</span><br><span class="line">extern int vscanf (const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vscanf&quot;)</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 1, 0))) ;</span><br><span class="line">extern int vsscanf (const char *__restrict __s, const char *__restrict __format, __gnuc_va_list __arg) __asm__ (&quot;&quot; &quot;__isoc99_vsscanf&quot;) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">     __attribute__ ((__format__ (__scanf__, 2, 0)));</span><br><span class="line">extern int fgetc (FILE *__stream);</span><br><span class="line">extern int getc (FILE *__stream);</span><br><span class="line">extern int getchar (void);</span><br><span class="line">extern int getc_unlocked (FILE *__stream);</span><br><span class="line">extern int getchar_unlocked (void);</span><br><span class="line">extern int fgetc_unlocked (FILE *__stream);</span><br><span class="line">extern int fputc (int __c, FILE *__stream);</span><br><span class="line">extern int putc (int __c, FILE *__stream);</span><br><span class="line">extern int putchar (int __c);</span><br><span class="line">extern int fputc_unlocked (int __c, FILE *__stream);</span><br><span class="line">extern int putc_unlocked (int __c, FILE *__stream);</span><br><span class="line">extern int putchar_unlocked (int __c);</span><br><span class="line">extern int getw (FILE *__stream);</span><br><span class="line">extern int putw (int __w, FILE *__stream);</span><br><span class="line">extern char *fgets (char *__restrict __s, int __n, FILE *__restrict __stream)</span><br><span class="line">     __attribute__ ((__access__ (__write_only__, 1, 2)));</span><br><span class="line">extern __ssize_t __getdelim (char **__restrict __lineptr,</span><br><span class="line">                             size_t *__restrict __n, int __delimiter,</span><br><span class="line">                             FILE *__restrict __stream) ;</span><br><span class="line">extern __ssize_t getdelim (char **__restrict __lineptr,</span><br><span class="line">                           size_t *__restrict __n, int __delimiter,</span><br><span class="line">                           FILE *__restrict __stream) ;</span><br><span class="line">extern __ssize_t getline (char **__restrict __lineptr,</span><br><span class="line">                          size_t *__restrict __n,</span><br><span class="line">                          FILE *__restrict __stream) ;</span><br><span class="line">extern int fputs (const char *__restrict __s, FILE *__restrict __stream);</span><br><span class="line">extern int puts (const char *__s);</span><br><span class="line">extern int ungetc (int __c, FILE *__stream);</span><br><span class="line">extern size_t fread (void *__restrict __ptr, size_t __size,</span><br><span class="line">       size_t __n, FILE *__restrict __stream) ;</span><br><span class="line">extern size_t fwrite (const void *__restrict __ptr, size_t __size,</span><br><span class="line">        size_t __n, FILE *__restrict __s);</span><br><span class="line">extern size_t fread_unlocked (void *__restrict __ptr, size_t __size,</span><br><span class="line">         size_t __n, FILE *__restrict __stream) ;</span><br><span class="line">extern size_t fwrite_unlocked (const void *__restrict __ptr, size_t __size,</span><br><span class="line">          size_t __n, FILE *__restrict __stream);</span><br><span class="line">extern int fseek (FILE *__stream, long int __off, int __whence);</span><br><span class="line">extern long int ftell (FILE *__stream) ;</span><br><span class="line">extern void rewind (FILE *__stream);</span><br><span class="line">extern int fseeko (FILE *__stream, __off_t __off, int __whence);</span><br><span class="line">extern __off_t ftello (FILE *__stream) ;</span><br><span class="line">extern int fgetpos (FILE *__restrict __stream, fpos_t *__restrict __pos);</span><br><span class="line">extern int fsetpos (FILE *__stream, const fpos_t *__pos);</span><br><span class="line">extern void clearerr (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int feof (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int ferror (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void clearerr_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int feof_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int ferror_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void perror (const char *__s);</span><br><span class="line">extern int fileno (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int fileno_unlocked (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern int pclose (FILE *__stream);</span><br><span class="line">extern FILE *popen (const char *__command, const char *__modes)</span><br><span class="line">  __attribute__ ((__malloc__)) __attribute__ ((__malloc__ (pclose, 1))) ;</span><br><span class="line">extern char *ctermid (char *__s) __attribute__ ((__nothrow__ , __leaf__))</span><br><span class="line">  __attribute__ ((__access__ (__write_only__, 1)));</span><br><span class="line">extern void flockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int ftrylockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__)) ;</span><br><span class="line">extern void funlockfile (FILE *__stream) __attribute__ ((__nothrow__ , __leaf__));</span><br><span class="line">extern int __uflow (FILE *);</span><br><span class="line">extern int __overflow (FILE *, int);</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    printf(&quot;hello&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h4><ul>
<li>å°†é«˜çº§è¯­è¨€è½¬å˜ä¸ºæ±‡ç¼–ï¼Œå¯è¿›è¡Œä»£ç ä¼˜åŒ–ï¼Œä¾‹å¦‚æ°§æ°”</li>
<li>gcc -S-masm&#x3D;intel main.cï¼Œä»¥intelè¯­æ³•ç¼–è¯‘ä¸ºæ±‡ç¼–</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">        .file   &quot;main.c&quot;</span><br><span class="line">        .intel_syntax noprefix</span><br><span class="line">        .text</span><br><span class="line">        .section        .rodata</span><br><span class="line">.LC0:</span><br><span class="line">        .string &quot;hello&quot;</span><br><span class="line">        .text</span><br><span class="line">        .globl  main</span><br><span class="line">        .type   main, @function</span><br><span class="line">main:</span><br><span class="line">.LFB0:</span><br><span class="line">        .cfi_startproc</span><br><span class="line">        push    rbp</span><br><span class="line">        .cfi_def_cfa_offset 16</span><br><span class="line">        .cfi_offset 6, -16</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        .cfi_def_cfa_register 6</span><br><span class="line">        lea     rax, .LC0[rip]</span><br><span class="line">        mov     rdi, rax</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        call    printf@PLT</span><br><span class="line">        mov     eax, 0</span><br><span class="line">        pop     rbp</span><br><span class="line">        .cfi_def_cfa 7, 8</span><br><span class="line">        ret</span><br><span class="line">        .cfi_endproc</span><br><span class="line">.LFE0:</span><br><span class="line">        .size   main, .-main</span><br><span class="line">        .ident  &quot;GCC: (Debian 11.3.0-5) 11.3.0&quot;</span><br><span class="line">        .section        .note.GNU-stack,&quot;&quot;,@progbits</span><br></pre></td></tr></table></figure>

<h4 id="æ±‡ç¼–"><a href="#æ±‡ç¼–" class="headerlink" title="æ±‡ç¼–"></a>æ±‡ç¼–</h4><ul>
<li>ç”Ÿæˆå¯é‡å®šå‘(<code>relocatable</code>)çš„æœºå™¨ä»£ç æ–‡ä»¶</li>
<li>gcc -c main.c</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file main.o</span><br><span class="line">main.o: ELF 64-bit LSB relocatable, x86-64, version 1 (SYSV), not stripped</span><br></pre></td></tr></table></figure>

<h4 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h4><ul>
<li>å°†æ‰€æœ‰éœ€è¦çš„æ–‡ä»¶é“¾æ¥åˆ°ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­</li>
<li>gcc main.c</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file a.out</span><br><span class="line">a.out: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=814605956fa139a9fa174f09ff3535861859bd21, for GNU/Linux 3.2.0, not stripped</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸è§å¯„å­˜å™¨ï¼ˆIntelï¼‰"><a href="#å¸¸è§å¯„å­˜å™¨ï¼ˆIntelï¼‰" class="headerlink" title="å¸¸è§å¯„å­˜å™¨ï¼ˆIntelï¼‰"></a>å¸¸è§å¯„å­˜å™¨ï¼ˆIntelï¼‰</h2><ul>
<li>é€šç”¨å¯„å­˜å™¨<ul>
<li>EAXï¼šï¼ˆé’ˆå¯¹æ“ä½œæ•°å’Œç»“æœæ•°æ®çš„ï¼‰ç´¯åŠ å™¨</li>
<li>EBXï¼šï¼ˆDSæ®µçš„æ•°æ®æŒ‡é’ˆï¼‰åŸºå€å¯„å­˜å™¨</li>
<li>ECXï¼šï¼ˆå­—ç¬¦ä¸²å’Œå¾ªç¯æ“ä½œçš„ï¼‰è®¡æ•°å™¨</li>
<li>EDXï¼šï¼ˆI&#x2F;OæŒ‡é’ˆï¼‰æ•°æ®å¯„å­˜å™¨</li>
<li>ESIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œæºæŒ‡é’ˆï¼‰æºå˜å€å¯„å­˜å™¨</li>
<li>EDIï¼šï¼ˆå­—ç¬¦ä¸²æ“ä½œç›®æ ‡æŒ‡é’ˆï¼‰ç›®çš„å˜å€å¯„å­˜å™¨</li>
<li>EBPï¼šï¼ˆSSæ®µä¸­æ ˆå†…æ•°æ®æŒ‡é’ˆï¼‰æ‰©å±•åŸºå€æŒ‡é’ˆå¯„å­˜å™¨[æ ˆå¸§å¯„å­˜å™¨ã€æ ˆåº•æŒ‡é’ˆå¯„å­˜å™¨]</li>
<li>ESPï¼šï¼ˆSSæ®µä¸­æ ˆæŒ‡é’ˆï¼‰æ ˆæŒ‡é’ˆå¯„å­˜å™¨[æŒ‡å‘æ ˆé¡¶]</li>
</ul>
</li>
<li>æ®µå¯„å­˜å™¨<ul>
<li>CSï¼šä»£ç æ®µå¯„å­˜å™¨</li>
<li>SSï¼šæ ˆæ®µå¯„å­˜å™¨</li>
<li>DSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
<li>FSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
<li>ESï¼šé™„åŠ æ•°æ®å¯„å­˜å™¨</li>
<li>GSï¼šæ•°æ®æ®µå¯„å­˜å™¨</li>
</ul>
</li>
<li>ç¨‹åºçŠ¶æ€ä¸æ§åˆ¶å¯„å­˜å™¨<ul>
<li>EFLAGSï¼šæ ‡å¿—å¯„å­˜å™¨ï¼Œ32ä¸ªä½å…ƒçš„01æ§åˆ¶<ul>
<li>ZF(é›¶æ ‡å¿—å™¨ï¼Œè¿ç®—ç»“æœä¸º0æ—¶ç½®1)</li>
<li>CF(è¿›ä½æ ‡å¿—ï¼Œè¿ç®—ç»“æœå‘æœ€é«˜ä½ä»¥ä¸Šè¿›ä½æ—¶ç½®1)</li>
<li>OF(æº¢å‡ºæ ‡å¿—)</li>
<li>AF(è¾…åŠ©è¿›ä½æ ‡å¿—ï¼Œè¿ç®—ç»“æœåœ¨ç¬¬3ä½çš„æ—¶å€™ç½®1)</li>
<li>SF(ç¬¦å·æ ‡å¿—ï¼Œæœ‰ç¬¦å·æ•´å‹çš„ç¬¦å·ä½ä¸º1æ—¶ç½®1)</li>
</ul>
</li>
</ul>
</li>
<li>æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨<ul>
<li>EIPï¼šä¿å­˜CPUè¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€</li>
</ul>
</li>
</ul>
<h2 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h2><ul>
<li><p>æ ˆç‰¹ç‚¹ï¼šFILOï¼ˆfirst in last outï¼‰</p>
</li>
<li><p>åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™éœ€è¦å°†å‚æ•°å‹å…¥æ ˆä¸­ï¼Œæ ˆé¡¶åœ°å€å‘ç”Ÿæ”¹å˜ï¼Œè€Œä½¿ç”¨ç»“æŸåˆéœ€è¦å°†å‚æ•°å¼¹å‡ºï¼Œå°†æ ˆæ¢å¤åˆ°è¢«è°ƒç”¨å‰çš„çŠ¶æ€ï¼Œä¸ºäº†ä¾¿äºç®¡ç†ï¼Œäºæ˜¯å‡ºç°äº†æ ˆå¸§ã€‚</p>
<ul>
<li><p>å®˜æ–¹è§£é‡Šï¼šåˆ©ç”¨EBPå¯„å­˜å™¨è®¿é—®æ ˆå†…å±€éƒ¨å˜é‡ã€å‚æ•°ã€å‡½æ•°è¿”å›åœ°å€çš„æ‰‹æ®µã€‚</p>
</li>
<li><p>å…·ä½“æ“ä½œï¼šåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œå°†ESPä¸­çš„æ ˆé¡¶åœ°å€å­˜å…¥EBPä¸­ï¼Œå°†è¯¥åœ°å€ä½œä¸ºåŸºå‡†ç‚¹ã€‚ç„¶åè°ƒç”¨å‡½æ•°ï¼ŒESPå¯„å­˜å™¨æ­£å¸¸è¿›è¡Œï¼Œå…¶é—´å¯é€šè¿‡EBPå»æ§åˆ¶è®¿é—®å˜é‡å‚æ•°ç­‰ç­‰ï¼Œåœ¨è°ƒç”¨ç»“æŸåï¼Œå†å°†EBPä¸­çš„åŸºå‡†ç‚¹åœ°å€ç»™åˆ°ESPï¼Œå°†æ ˆçš„çŠ¶æ€æ¢å¤åˆ°å‡½æ•°è°ƒç”¨å‰</p>
</li>
<li><p>ä»£ç æµç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PUSH EBP          ;å‡½æ•°å¼€å§‹</span><br><span class="line">MOV  EBP,ESP      ;å°†æ ˆé¡¶åœ°å€å­˜å…¥EBPä¸­</span><br><span class="line"></span><br><span class="line">....              ;å‡½æ•°æ‰§è¡Œï¼ŒæœŸé—´EBPåœ°å€ä¸å˜</span><br><span class="line"></span><br><span class="line">MOV  ESP,EBP      ;åŸºå‡†ç‚¹åœ°å€ç»™åˆ°ESP</span><br><span class="line">POP EBP           ;æ ˆçŠ¶æ€æ¢å¤ï¼Œå¼¹å‡ºEBP</span><br><span class="line">RETN              ;å‡½æ•°ç»“æŸ</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="å‡½æ•°è°ƒç”¨çº¦å®š"><a href="#å‡½æ•°è°ƒç”¨çº¦å®š" class="headerlink" title="å‡½æ•°è°ƒç”¨çº¦å®š"></a>å‡½æ•°è°ƒç”¨çº¦å®š</h2><p>(Calling Convention)</p>
<ul>
<li><p>ä¸‰ç§æ–¹å¼(cdcel, stdcall, fastcall)</p>
<ul>
<li><p>cdcel<br>ä¸»è¦è¿ç”¨äºcè¯­è¨€ï¼Œç”±è°ƒç”¨è€…è´Ÿè´£æ¸…ç†æ ˆ</p>
<blockquote>
<p>å‡½æ•°è°ƒç”¨ç»“æŸåé€šè¿‡ç§»åŠ¨ESPï¼Œæ¢å¤åˆ°è°ƒç”¨å‰çš„æ ˆçŠ¶æ€</p>
</blockquote>
</li>
<li><p>stdcall<br>ä¸»è¦è¿ç”¨äºWin32 APIï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†æ ˆ</p>
<blockquote>
<p>åœ¨è¢«è°ƒç”¨å‡½æ•°çš„ç»“å°¾é€šè¿‡RETNè¯­å¥ç§»åŠ¨ESPåˆ°åŸä½ç½®</p>
</blockquote>
</li>
<li><p>fastcall</p>
<blockquote>
<p>ä½¿ç”¨å¯„å­˜å™¨å»ä¼ é€’å‡½æ•°çš„éƒ¨åˆ†å‚æ•°ï¼Œå®ç°å¿«é€Ÿè°ƒç”¨</p>
</blockquote>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/31/Z3&yafu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="UmVfX1BvaW50">
      <meta itemprop="description" content="å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€†å‘å…‰ç‚¹">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/31/Z3&yafu/" class="post-title-link" itemprop="url">Z3 & Yafu</a>
        </h2>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-03-31 19:02:27" itemprop="dateCreated datePublished" datetime="2023-03-31T19:02:27+08:00">2023-03-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-04-01 09:55:11" itemprop="dateModified" datetime="2023-04-01T09:55:11+08:00">2023-04-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Z3"><a href="#Z3" class="headerlink" title="Z3"></a>Z3</h2><h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><blockquote>
<p>ç›´æ¥æåˆ°ç½‘ç›˜ä¸Šç”¨é“¾æ¥å§ï¼š<br>é“¾æ¥ï¼š(<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234">https://pan.baidu.com/s/1gni_eYUC-Y_dQVogJh9QyA?pwd=1234</a>)<br>æå–ç ï¼š1234</p>
</blockquote>
<ol>
<li>ä¸‹è½½è§£å‹</li>
<li>å°†æ–‡ä»¶ä¸­binç›®å½•é…ç½®åˆ°ç³»ç»Ÿå˜é‡pathä¸­</li>
<li>æ–°å»ºPYTHONPATHç³»ç»Ÿå˜é‡ï¼Œè·¯å¾„ä¸ºbin&#x2F;pythonç›®å½•</li>
</ol>
<h3 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h3><ol>
<li>open cmd</li>
</ol>
<blockquote>
<p>Open the bin&#x2F;Python directory in cmd</p>
</blockquote>
<p>or</p>
<blockquote>
<p>åœ¨bin&#x2F;pythonç›®å½•ä¸‹shiftå³é”®powershell</p>
</blockquote>
<ol>
<li>run python</li>
<li>import code</li>
</ol>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><ul>
<li><p>example for authority</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from z3 import *</span><br><span class="line">x = Real(&#x27;x&#x27;)</span><br><span class="line">y = Real(&#x27;y&#x27;)</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(x + y &gt; 5, x &gt; 1, y &gt; 1)</span><br><span class="line">print(s.check())</span><br><span class="line">print(s.model())</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç®€å•è¯´ä¸€ä¸‹</p>
</li>
</ul>
<ol>
<li>å¯¼åŒ…z3</li>
<li>a &#x3D; Real(b), aä¸ºæ–¹ç¨‹ä¸­çš„æœªçŸ¥æ•°ï¼Œbä¸ºè¾“å‡ºæ—¶å€™ç”¨æ¥è¡¨ç¤ºaçš„å˜é‡</li>
<li>Solver()ï¼Œç®€è¨€ä¹‹ï¼šè§£å†³å‡½æ•°ï¼Œæ–¹ç¨‹æ¥æ”¶å™¨</li>
<li>add()ï¼Œæ‹¬å·é‡Œå¡æ–¹ç¨‹å°±è¡Œï¼Œç”¨â€œ,â€éš”å¼€ï¼Œæˆ–è€…ä½ å¤šç”¨å‡ ä¸ªadd()ä¹Ÿè¡Œ</li>
<li>åé¢ä¿©ä¸ç”¨åŠ¨äº†ï¼Œå°±é‚£æ ·</li>
<li>å›è½¦å‡ºç»“æœ</li>
</ol>
<h2 id="yafu"><a href="#yafu" class="headerlink" title="yafu"></a>yafu</h2><h3 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h3><ul>
<li>Yafu is a tool that can be used for prime factor decomposition</li>
</ul>
<h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><ul>
<li><a target="_blank" rel="noopener" href="https://sourceforge.net/projects/yafu/">https://sourceforge.net/projects/yafu/</a></li>
</ul>
<h3 id="Use-1"><a href="#Use-1" class="headerlink" title="Use"></a>Use</h3><ul>
<li>Execute yafu-x64.exe in the file in cmd</li>
</ul>
<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><ul>
<li>factor(num)</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">UmVfX1BvaW50</p>
  <div class="site-description" itemprop="description">å·²ç»é­”åŒ–çš„CTFé€†å‘æ‰‹</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">UmVfX1BvaW50</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
